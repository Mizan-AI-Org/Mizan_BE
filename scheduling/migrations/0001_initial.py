# Generated by Django 5.1.4 on 2025-11-17 09:55

import datetime
import django.db.models.deletion
import django.utils.timezone
import scheduling.audit
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('accounts', '0001_initial'),
        ('contenttypes', '0002_remove_content_type_name'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AssignedShift',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('shift_date', models.DateField()),
                ('start_time', models.DateTimeField(blank=True, null=True)),
                ('end_time', models.DateTimeField(blank=True, null=True)),
                ('break_duration', models.DurationField(default=datetime.timedelta(seconds=1800))),
                ('role', models.CharField(choices=[('SUPER_ADMIN', 'Super Admin'), ('ADMIN', 'Admin'), ('CHEF', 'Chef'), ('WAITER', 'Waiter'), ('CLEANER', 'Cleaner'), ('CASHIER', 'Cashier')], max_length=20)),
                ('status', models.CharField(choices=[('SCHEDULED', 'Scheduled'), ('CONFIRMED', 'Confirmed'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled'), ('NO_SHOW', 'No Show')], default='SCHEDULED', max_length=20)),
                ('notes', models.TextField(blank=True, null=True)),
                ('is_confirmed', models.BooleanField(default=False)),
                ('color', models.CharField(blank=True, default='#6b7280', max_length=7, null=True)),
                ('required_skills', models.JSONField(default=list, help_text='List of required skills for this shift')),
                ('required_certifications', models.JSONField(default=list, help_text='List of required certifications')),
                ('equipment_needed', models.JSONField(default=list, help_text='List of required equipment/tools')),
                ('preparation_instructions', models.TextField(blank=True, help_text='Special preparation instructions', null=True)),
                ('workspace_location', models.CharField(blank=True, help_text='Specific workspace/station assignment', max_length=255, null=True)),
                ('department', models.CharField(blank=True, help_text='Department assignment', max_length=100, null=True)),
                ('safety_briefing_required', models.BooleanField(default=False)),
                ('safety_briefing_completed', models.BooleanField(default=False)),
                ('safety_briefing_completed_at', models.DateTimeField(blank=True, null=True)),
                ('compliance_checks_required', models.JSONField(default=list, help_text='List of required compliance checks')),
                ('notification_sent', models.BooleanField(default=False)),
                ('notification_sent_at', models.DateTimeField(blank=True, null=True)),
                ('notification_channels', models.JSONField(default=list, help_text='Channels used for notification (whatsapp, email, app)')),
                ('timezone', models.CharField(default='UTC', help_text='Timezone for shift times', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_shifts', to=settings.AUTH_USER_MODEL)),
                ('last_modified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modified_shifts', to=settings.AUTH_USER_MODEL)),
                ('staff', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assigned_shifts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'assigned_shifts',
                'ordering': ['shift_date', 'start_time'],
            },
        ),
        migrations.CreateModel(
            name='Process',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('ACTIVE', 'Active'), ('PAUSED', 'Paused'), ('ARCHIVED', 'Archived')], default='DRAFT', max_length=20)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('sop_document', models.TextField(blank=True, null=True)),
                ('sop_steps', models.JSONField(default=list)),
                ('is_critical', models.BooleanField(default=False)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_processes', to=settings.AUTH_USER_MODEL)),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='processes', to='accounts.restaurant')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_processes', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'processes',
                'ordering': ['-created_at'],
            },
            bases=(scheduling.audit.AuditMixin, models.Model),
        ),
        migrations.CreateModel(
            name='ScheduleTemplate',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='accounts.restaurant')),
            ],
            options={
                'db_table': 'schedule_templates',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='ShiftSwapRequest',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('CANCELLED', 'Cancelled')], default='PENDING', max_length=20)),
                ('request_message', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('receiver', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='received_swap_requests', to=settings.AUTH_USER_MODEL)),
                ('requester', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='initiated_swap_requests', to=settings.AUTH_USER_MODEL)),
                ('shift_to_swap', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='swap_requests_out', to='scheduling.assignedshift')),
            ],
            options={
                'db_table': 'shift_swap_requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='TaskCategory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, null=True)),
                ('color', models.CharField(default='#3B82F6', max_length=7)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='task_categories', to='accounts.restaurant')),
            ],
            options={
                'verbose_name_plural': 'Task Categories',
                'db_table': 'task_categories',
            },
        ),
        migrations.CreateModel(
            name='ShiftTask',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=20)),
                ('status', models.CharField(choices=[('TODO', 'To Do'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], default='TODO', max_length=20)),
                ('estimated_duration', models.DurationField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('sop_document', models.TextField(blank=True, help_text='Standard Operating Procedure instructions', null=True)),
                ('sop_steps', models.JSONField(default=list, help_text='Step-by-step SOP instructions as JSON array')),
                ('sop_version', models.CharField(blank=True, help_text='SOP version number', max_length=20, null=True)),
                ('compliance_checks', models.JSONField(default=list, help_text='List of required compliance checks')),
                ('safety_requirements', models.JSONField(default=list, help_text='Safety requirements and protocols')),
                ('quality_standards', models.JSONField(default=list, help_text='Quality control standards to meet')),
                ('verification_type', models.CharField(choices=[('NONE', 'No Verification Required'), ('PHOTO', 'Photo Evidence Required'), ('DOCUMENT', 'Document Upload Required'), ('SIGNATURE', 'Digital Signature Required'), ('CHECKLIST', 'Checklist Completion Required'), ('SUPERVISOR_APPROVAL', 'Supervisor Approval Required'), ('TEMPERATURE_LOG', 'Temperature Recording Required'), ('QUANTITY_COUNT', 'Quantity/Count Recording Required')], default='NONE', max_length=30)),
                ('verification_required', models.BooleanField(default=False)),
                ('verification_instructions', models.TextField(blank=True, help_text='Instructions for verification process', null=True)),
                ('verification_checklist', models.JSONField(default=list, help_text='Checklist items for verification')),
                ('required_equipment', models.JSONField(default=list, help_text='List of required equipment/tools')),
                ('required_materials', models.JSONField(default=list, help_text='List of required materials/supplies')),
                ('required_skills', models.JSONField(default=list, help_text='Skills required to complete this task')),
                ('required_certifications', models.JSONField(default=list, help_text='Certifications required for this task')),
                ('maintenance_type', models.CharField(blank=True, help_text='Type of maintenance task', max_length=100, null=True)),
                ('maintenance_frequency', models.CharField(blank=True, help_text='How often this maintenance should occur', max_length=50, null=True)),
                ('last_maintenance_date', models.DateTimeField(blank=True, help_text='When this maintenance was last performed', null=True)),
                ('is_critical', models.BooleanField(default=False, help_text='Mark as critical task requiring immediate attention')),
                ('supervisor_notification_required', models.BooleanField(default=False, help_text='Notify supervisor when task status changes')),
                ('completion_percentage', models.IntegerField(default=0, help_text='Task completion percentage (0-100)')),
                ('actual_duration', models.DurationField(blank=True, help_text='Actual time taken to complete task', null=True)),
                ('started_at', models.DateTimeField(blank=True, help_text='When task was started', null=True)),
                ('location_specific', models.CharField(blank=True, help_text='Specific location where task should be performed', max_length=255, null=True)),
                ('environmental_conditions', models.JSONField(default=dict, help_text='Required environmental conditions (temperature, humidity, etc.)')),
                ('is_recurring', models.BooleanField(default=False)),
                ('recurrence_pattern', models.CharField(blank=True, help_text='Pattern for recurring tasks (daily, weekly, etc.)', max_length=50, null=True)),
                ('next_occurrence', models.DateTimeField(blank=True, help_text='When this task should next occur', null=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='shift_assigned_tasks', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='shift_created_tasks', to=settings.AUTH_USER_MODEL)),
                ('depends_on_tasks', models.ManyToManyField(blank=True, help_text='Tasks that must be completed before this one', related_name='dependent_tasks', to='scheduling.shifttask')),
                ('parent_task', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='subtasks', to='scheduling.shifttask')),
                ('shift', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='scheduling.assignedshift')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='shift_tasks', to='scheduling.taskcategory')),
            ],
            options={
                'db_table': 'shift_tasks',
                'ordering': ['-priority', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='ProcessTask',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=20)),
                ('status', models.CharField(choices=[('TODO', 'To Do'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], default='TODO', max_length=20)),
                ('due_date', models.DateField(blank=True, null=True)),
                ('due_time', models.TimeField(blank=True, null=True)),
                ('estimated_duration', models.DurationField(blank=True, null=True)),
                ('verification_type', models.CharField(choices=[('NONE', 'No Verification Required'), ('PHOTO', 'Photo Evidence Required'), ('DOCUMENT', 'Document Upload Required'), ('SIGNATURE', 'Digital Signature Required'), ('CHECKLIST', 'Checklist Completion Required'), ('SUPERVISOR_APPROVAL', 'Supervisor Approval Required')], default='NONE', max_length=30)),
                ('verification_required', models.BooleanField(default=False)),
                ('progress', models.IntegerField(default=0)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('completion_notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_process_tasks', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_process_tasks', to=settings.AUTH_USER_MODEL)),
                ('parent_task', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='subtasks', to='scheduling.processtask')),
                ('process', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='scheduling.process')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_process_tasks', to=settings.AUTH_USER_MODEL)),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='process_tasks', to='scheduling.taskcategory')),
            ],
            options={
                'db_table': 'process_tasks',
                'ordering': ['due_date', 'priority'],
            },
            bases=(scheduling.audit.AuditMixin, models.Model),
        ),
        migrations.CreateModel(
            name='TaskComplianceCheck',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('check_name', models.CharField(help_text='Name of the compliance check', max_length=255)),
                ('check_description', models.TextField(help_text='Description of what needs to be checked')),
                ('check_criteria', models.JSONField(default=dict, help_text='Specific criteria for passing this check')),
                ('status', models.CharField(choices=[('NOT_STARTED', 'Not Started'), ('IN_PROGRESS', 'In Progress'), ('PASSED', 'Passed'), ('FAILED', 'Failed'), ('REQUIRES_ATTENTION', 'Requires Attention')], default='NOT_STARTED', max_length=20)),
                ('result_data', models.JSONField(default=dict, help_text='Data collected during the check')),
                ('pass_criteria_met', models.BooleanField(default=False)),
                ('supervisor_reviewed', models.BooleanField(default=False)),
                ('supervisor_notes', models.TextField(blank=True, null=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('regulation_reference', models.CharField(blank=True, help_text='Reference to specific regulation or standard', max_length=255, null=True)),
                ('compliance_level', models.CharField(blank=True, help_text='Level of compliance required (e.g., FDA, OSHA)', max_length=50, null=True)),
                ('checked_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='performed_compliance_checks', to=settings.AUTH_USER_MODEL)),
                ('task', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='compliance_check_records', to='scheduling.shifttask')),
            ],
            options={
                'db_table': 'task_compliance_checks',
                'ordering': ['check_name'],
            },
        ),
        migrations.CreateModel(
            name='TaskTemplate',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('template_type', models.CharField(choices=[('CLEANING', 'Daily Restaurant Cleaning Schedule'), ('TEMPERATURE', 'Daily Temperature Log'), ('OPENING', 'Restaurant Manager Opening Checklist'), ('CLOSING', 'Restaurant Manager Closing Checklist'), ('HEALTH', 'Monthly Health and Safety Inspection'), ('SOP', 'Standard Operating Procedure'), ('MAINTENANCE', 'Equipment Maintenance'), ('COMPLIANCE', 'Compliance Check'), ('SAFETY', 'Safety Protocol'), ('QUALITY', 'Quality Control'), ('CUSTOM', 'Custom Template')], max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tasks', models.JSONField(default=list)),
                ('frequency', models.CharField(choices=[('DAILY', 'Daily'), ('WEEKLY', 'Weekly'), ('MONTHLY', 'Monthly'), ('QUARTERLY', 'Quarterly'), ('ANNUALLY', 'Annually'), ('CUSTOM', 'Custom')], default='DAILY', max_length=20)),
                ('ai_generated', models.BooleanField(default=False)),
                ('ai_prompt', models.TextField(blank=True, null=True)),
                ('sop_document', models.TextField(blank=True, help_text='Standard Operating Procedure instructions', null=True)),
                ('sop_steps', models.JSONField(default=list, help_text='Step-by-step SOP instructions as JSON array')),
                ('sop_version', models.CharField(blank=True, help_text='SOP version number', max_length=20, null=True)),
                ('sop_last_updated', models.DateTimeField(blank=True, help_text='When SOP was last updated', null=True)),
                ('compliance_checks', models.JSONField(default=list, help_text='List of required compliance checks')),
                ('safety_requirements', models.JSONField(default=list, help_text='Safety requirements and protocols')),
                ('quality_standards', models.JSONField(default=list, help_text='Quality control standards to meet')),
                ('regulatory_requirements', models.JSONField(default=list, help_text='Regulatory compliance requirements')),
                ('verification_type', models.CharField(choices=[('NONE', 'No Verification Required'), ('PHOTO', 'Photo Evidence Required'), ('DOCUMENT', 'Document Upload Required'), ('SIGNATURE', 'Digital Signature Required'), ('CHECKLIST', 'Checklist Completion Required'), ('SUPERVISOR_APPROVAL', 'Supervisor Approval Required'), ('TEMPERATURE_LOG', 'Temperature Recording Required'), ('QUANTITY_COUNT', 'Quantity/Count Recording Required')], default='NONE', max_length=30)),
                ('verification_required', models.BooleanField(default=False)),
                ('verification_instructions', models.TextField(blank=True, help_text='Instructions for verification process', null=True)),
                ('verification_checklist', models.JSONField(default=list, help_text='Checklist items for verification')),
                ('required_equipment', models.JSONField(default=list, help_text='List of required equipment/tools')),
                ('required_materials', models.JSONField(default=list, help_text='List of required materials/supplies')),
                ('required_skills', models.JSONField(default=list, help_text='Skills required to complete tasks in this template')),
                ('required_certifications', models.JSONField(default=list, help_text='Certifications required for tasks in this template')),
                ('estimated_duration', models.DurationField(blank=True, help_text='Estimated time to complete all tasks', null=True)),
                ('difficulty_level', models.CharField(choices=[('BEGINNER', 'Beginner'), ('INTERMEDIATE', 'Intermediate'), ('ADVANCED', 'Advanced'), ('EXPERT', 'Expert')], default='INTERMEDIATE', max_length=20)),
                ('is_critical', models.BooleanField(default=False, help_text='Mark as critical template requiring immediate attention')),
                ('priority_level', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=20)),
                ('version', models.CharField(default='1.0', help_text='Template version number', max_length=20)),
                ('is_latest_version', models.BooleanField(default=True)),
                ('requires_approval', models.BooleanField(default=False, help_text='Whether tasks from this template require supervisor approval')),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('usage_count', models.IntegerField(default=0, help_text='Number of times this template has been used')),
                ('last_used', models.DateTimeField(blank=True, help_text='When this template was last used', null=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_templates', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_templates', to=settings.AUTH_USER_MODEL)),
                ('parent_template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='versions', to='scheduling.tasktemplate')),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='task_templates', to='accounts.restaurant')),
            ],
            options={
                'db_table': 'task_templates',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Task',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='MEDIUM', max_length=20)),
                ('status', models.CharField(choices=[('TODO', 'To Do'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], default='TODO', max_length=20)),
                ('progress', models.IntegerField(default=0)),
                ('due_date', models.DateField(blank=True, null=True)),
                ('due_time', models.DateTimeField(blank=True, null=True)),
                ('estimated_duration', models.DurationField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('completion_notes', models.TextField(blank=True, null=True)),
                ('completion_evidence', models.ImageField(blank=True, null=True, upload_to='task_evidence/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('reminder_enabled', models.BooleanField(default=True)),
                ('reminder_time', models.DurationField(default=datetime.timedelta(seconds=3600))),
                ('sop_document', models.TextField(blank=True, help_text='Standard Operating Procedure instructions', null=True)),
                ('sop_steps', models.JSONField(default=list, help_text='Step-by-step SOP instructions as JSON array')),
                ('sop_version', models.CharField(blank=True, help_text='SOP version number', max_length=20, null=True)),
                ('compliance_checks', models.JSONField(default=list, help_text='List of required compliance checks')),
                ('safety_requirements', models.JSONField(default=list, help_text='Safety requirements and protocols')),
                ('quality_standards', models.JSONField(default=list, help_text='Quality control standards to meet')),
                ('verification_type', models.CharField(choices=[('NONE', 'No Verification Required'), ('PHOTO', 'Photo Evidence Required'), ('DOCUMENT', 'Document Upload Required'), ('SIGNATURE', 'Digital Signature Required'), ('CHECKLIST', 'Checklist Completion Required'), ('SUPERVISOR_APPROVAL', 'Supervisor Approval Required'), ('TEMPERATURE_LOG', 'Temperature Recording Required'), ('QUANTITY_COUNT', 'Quantity/Count Recording Required')], default='NONE', max_length=30)),
                ('verification_required', models.BooleanField(default=False)),
                ('verification_instructions', models.TextField(blank=True, help_text='Instructions for verification process', null=True)),
                ('verification_checklist', models.JSONField(default=list, help_text='Checklist items for verification')),
                ('required_equipment', models.JSONField(default=list, help_text='List of required equipment/tools')),
                ('required_materials', models.JSONField(default=list, help_text='List of required materials/supplies')),
                ('required_skills', models.JSONField(default=list, help_text='Skills required to complete this task')),
                ('required_certifications', models.JSONField(default=list, help_text='Certifications required for this task')),
                ('is_critical', models.BooleanField(default=False, help_text='Mark as critical task requiring immediate attention')),
                ('supervisor_notification_required', models.BooleanField(default=False, help_text='Notify supervisor when task status changes')),
                ('actual_duration', models.DurationField(blank=True, help_text='Actual time taken to complete task', null=True)),
                ('started_at', models.DateTimeField(blank=True, help_text='When task was started', null=True)),
                ('location_specific', models.CharField(blank=True, help_text='Specific location where task should be performed', max_length=255, null=True)),
                ('environmental_conditions', models.JSONField(default=dict, help_text='Required environmental conditions (temperature, humidity, etc.)')),
                ('progress_percentage', models.IntegerField(default=0, help_text='Progress percentage (0-100)')),
                ('progress_notes', models.TextField(blank=True, help_text='Notes about current progress', null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, help_text='When task was last updated')),
                ('checkpoints', models.JSONField(default=list, help_text='Progress checkpoints with timestamps and photos')),
                ('completion_photo', models.ImageField(blank=True, help_text='Photo evidence of task completion', null=True, upload_to='task_completions/')),
                ('completion_location', models.CharField(blank=True, help_text='Location where task was completed', max_length=255, null=True)),
                ('is_recurring', models.BooleanField(default=False)),
                ('recurrence_pattern', models.CharField(blank=True, help_text='Pattern for recurring tasks (daily, weekly, etc.)', max_length=50, null=True)),
                ('next_occurrence', models.DateTimeField(blank=True, help_text='When this task should next occur', null=True)),
                ('assigned_shift', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='template_tasks', to='scheduling.assignedshift')),
                ('assigned_to', models.ManyToManyField(related_name='template_assigned_tasks', to=settings.AUTH_USER_MODEL)),
                ('completed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='template_completed_tasks', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='template_created_tasks', to=settings.AUTH_USER_MODEL)),
                ('depends_on_tasks', models.ManyToManyField(blank=True, help_text='Tasks that must be completed before this one', related_name='dependent_tasks', to='scheduling.task')),
                ('parent_task', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='subtasks', to='scheduling.task')),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='template_tasks', to='accounts.restaurant')),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='template_tasks', to='scheduling.taskcategory')),
                ('template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='generated_tasks', to='scheduling.tasktemplate')),
            ],
            options={
                'db_table': 'template_tasks',
                'ordering': ['due_date', 'due_time', 'priority'],
            },
        ),
        migrations.CreateModel(
            name='TaskVerificationRecord',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('photo_evidence', models.JSONField(default=list, help_text='List of photo URLs/paths as evidence')),
                ('document_evidence', models.JSONField(default=list, help_text='List of document URLs/paths as evidence')),
                ('signature_data', models.TextField(blank=True, help_text='Digital signature data', null=True)),
                ('checklist_responses', models.JSONField(default=dict, help_text='Responses to verification checklist items')),
                ('temperature_readings', models.JSONField(default=list, help_text='Temperature readings with timestamps')),
                ('quantity_counts', models.JSONField(default=dict, help_text='Quantity counts and measurements')),
                ('measurement_data', models.JSONField(default=dict, help_text='Other measurement data')),
                ('verification_status', models.CharField(choices=[('PENDING', 'Pending Verification'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('REQUIRES_REVISION', 'Requires Revision')], default='PENDING', max_length=20)),
                ('verification_notes', models.TextField(blank=True, help_text='Notes from verifier', null=True)),
                ('rejection_reason', models.TextField(blank=True, help_text='Reason for rejection if applicable', null=True)),
                ('submitted_at', models.DateTimeField(auto_now_add=True)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('gps_coordinates', models.JSONField(default=dict, help_text='GPS coordinates where verification was submitted')),
                ('location_verified', models.BooleanField(default=False, help_text='Whether location was verified')),
                ('submitted_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='submitted_verifications', to=settings.AUTH_USER_MODEL)),
                ('task', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='verification_records', to='scheduling.shifttask')),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_tasks', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'task_verification_records',
                'ordering': ['-submitted_at'],
            },
        ),
        migrations.CreateModel(
            name='TemplateShift',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('role', models.CharField(choices=[('SUPER_ADMIN', 'Super Admin'), ('ADMIN', 'Admin'), ('CHEF', 'Chef'), ('WAITER', 'Waiter'), ('CLEANER', 'Cleaner'), ('CASHIER', 'Cashier')], max_length=20)),
                ('day_of_week', models.IntegerField(choices=[(0, 'Monday'), (1, 'Tuesday'), (2, 'Wednesday'), (3, 'Thursday'), (4, 'Friday'), (5, 'Saturday'), (6, 'Sunday')])),
                ('start_time', models.DateTimeField(blank=True, null=True)),
                ('end_time', models.DateTimeField(blank=True, null=True)),
                ('required_staff', models.IntegerField(default=1)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shifts', to='scheduling.scheduletemplate')),
            ],
        ),
        migrations.CreateModel(
            name='TemplateVersion',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('version_number', models.CharField(max_length=20)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('ACTIVE', 'Active'), ('ARCHIVED', 'Archived'), ('DEPRECATED', 'Deprecated')], default='DRAFT', max_length=20)),
                ('description', models.TextField(blank=True, null=True)),
                ('changes_summary', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('activated_at', models.DateTimeField(blank=True, null=True)),
                ('archived_at', models.DateTimeField(blank=True, null=True)),
                ('is_current', models.BooleanField(default=False)),
                ('template_data', models.JSONField(default=dict, help_text='Snapshot of template configuration')),
                ('shifts_data', models.JSONField(default=list, help_text='Snapshot of template shifts')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='versions', to='scheduling.scheduletemplate')),
            ],
            options={
                'db_table': 'template_versions',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Timesheet',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('total_hours', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('total_earnings', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('hourly_rate', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('SUBMITTED', 'Submitted'), ('APPROVED', 'Approved'), ('PAID', 'Paid'), ('REJECTED', 'Rejected')], default='DRAFT', max_length=20)),
                ('notes', models.TextField(blank=True, null=True)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('paid_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_timesheets', to=settings.AUTH_USER_MODEL)),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='timesheets', to='accounts.restaurant')),
                ('staff', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='timesheets', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'timesheets',
                'ordering': ['-end_date'],
            },
        ),
        migrations.CreateModel(
            name='TimesheetEntry',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('hours_worked', models.DecimalField(decimal_places=2, max_digits=6)),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('shift', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='scheduling.assignedshift')),
                ('timesheet', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='entries', to='scheduling.timesheet')),
            ],
            options={
                'db_table': 'timesheet_entries',
            },
        ),
        migrations.CreateModel(
            name='WeeklySchedule',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('week_start', models.DateField()),
                ('week_end', models.DateField()),
                ('is_published', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('restaurant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='accounts.restaurant')),
            ],
        ),
        migrations.AddField(
            model_name='assignedshift',
            name='schedule',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assigned_shifts', to='scheduling.weeklyschedule'),
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('timestamp', models.DateTimeField(db_index=True, default=django.utils.timezone.now)),
                ('action', models.CharField(choices=[('CREATE', 'Create'), ('UPDATE', 'Update'), ('DELETE', 'Delete'), ('VIEW', 'View'), ('ASSIGN', 'Assign'), ('UNASSIGN', 'Unassign'), ('START', 'Start'), ('COMPLETE', 'Complete'), ('PAUSE', 'Pause'), ('RESUME', 'Resume'), ('APPROVE', 'Approve'), ('REJECT', 'Reject'), ('EXPORT', 'Export'), ('IMPORT', 'Import'), ('LOGIN', 'Login'), ('LOGOUT', 'Logout'), ('BULK_UPDATE', 'Bulk Update'), ('TEMPLATE_APPLY', 'Template Apply'), ('SCHEDULE_PUBLISH', 'Schedule Publish'), ('SHIFT_SWAP', 'Shift Swap'), ('TASK_REASSIGN', 'Task Reassign'), ('PROGRESS_UPDATE', 'Progress Update'), ('CHECKPOINT_ADD', 'Checkpoint Add'), ('PHOTO_UPLOAD', 'Photo Upload')], db_index=True, max_length=50)),
                ('severity', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('CRITICAL', 'Critical')], default='LOW', max_length=20)),
                ('object_id', models.CharField(blank=True, max_length=255, null=True)),
                ('description', models.TextField()),
                ('old_values', models.JSONField(blank=True, null=True)),
                ('new_values', models.JSONField(blank=True, null=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True, null=True)),
                ('session_key', models.CharField(blank=True, max_length=40, null=True)),
                ('content_type', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('restaurant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='accounts.restaurant')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'audit_log',
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['timestamp', 'restaurant'], name='audit_log_timesta_c74bd9_idx'), models.Index(fields=['user', 'action'], name='audit_log_user_id_f94cfc_idx'), models.Index(fields=['content_type', 'object_id'], name='audit_log_content_10f046_idx'), models.Index(fields=['action', 'severity'], name='audit_log_action_a34304_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='process',
            index=models.Index(fields=['restaurant', 'status'], name='processes_restaur_3fe8cf_idx'),
        ),
        migrations.AddIndex(
            model_name='process',
            index=models.Index(fields=['is_active'], name='processes_is_acti_d0033d_idx'),
        ),
        migrations.AddIndex(
            model_name='scheduletemplate',
            index=models.Index(fields=['restaurant', 'is_active'], name='schedule_te_restaur_e16a6a_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='taskcategory',
            unique_together={('restaurant', 'name')},
        ),
        migrations.AddIndex(
            model_name='shifttask',
            index=models.Index(fields=['shift', 'status'], name='shift_tasks_shift_i_ca057f_idx'),
        ),
        migrations.AddIndex(
            model_name='shifttask',
            index=models.Index(fields=['assigned_to', 'status'], name='shift_tasks_assigne_2f3a42_idx'),
        ),
        migrations.AddIndex(
            model_name='processtask',
            index=models.Index(fields=['process', 'status'], name='process_tas_process_71de1a_idx'),
        ),
        migrations.AddIndex(
            model_name='processtask',
            index=models.Index(fields=['assigned_to', 'status'], name='process_tas_assigne_0ecdaa_idx'),
        ),
        migrations.AddIndex(
            model_name='taskcompliancecheck',
            index=models.Index(fields=['task', 'status'], name='task_compli_task_id_98d4ff_idx'),
        ),
        migrations.AddIndex(
            model_name='taskcompliancecheck',
            index=models.Index(fields=['status', 'completed_at'], name='task_compli_status_f571db_idx'),
        ),
        migrations.AddIndex(
            model_name='tasktemplate',
            index=models.Index(fields=['restaurant', 'template_type'], name='task_templa_restaur_a02412_idx'),
        ),
        migrations.AddIndex(
            model_name='tasktemplate',
            index=models.Index(fields=['frequency'], name='task_templa_frequen_a0e85e_idx'),
        ),
        migrations.AddIndex(
            model_name='task',
            index=models.Index(fields=['restaurant', 'status'], name='template_ta_restaur_9180ba_idx'),
        ),
        migrations.AddIndex(
            model_name='task',
            index=models.Index(fields=['due_date'], name='template_ta_due_dat_f364c4_idx'),
        ),
        migrations.AddIndex(
            model_name='task',
            index=models.Index(fields=['priority'], name='template_ta_priorit_3d350b_idx'),
        ),
        migrations.AddIndex(
            model_name='taskverificationrecord',
            index=models.Index(fields=['task', 'verification_status'], name='task_verifi_task_id_53a25c_idx'),
        ),
        migrations.AddIndex(
            model_name='taskverificationrecord',
            index=models.Index(fields=['submitted_by', 'submitted_at'], name='task_verifi_submitt_d71532_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='templateshift',
            unique_together={('template', 'role', 'day_of_week')},
        ),
        migrations.AddIndex(
            model_name='templateversion',
            index=models.Index(fields=['template', 'status'], name='template_ve_templat_e43452_idx'),
        ),
        migrations.AddIndex(
            model_name='templateversion',
            index=models.Index(fields=['status', 'created_at'], name='template_ve_status_c8a8ae_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='templateversion',
            unique_together={('template', 'version_number')},
        ),
        migrations.AddIndex(
            model_name='timesheet',
            index=models.Index(fields=['staff', 'status'], name='timesheets_staff_i_379135_idx'),
        ),
        migrations.AddIndex(
            model_name='timesheet',
            index=models.Index(fields=['restaurant', 'status'], name='timesheets_restaur_be3009_idx'),
        ),
        migrations.AddIndex(
            model_name='timesheet',
            index=models.Index(fields=['end_date'], name='timesheets_end_dat_d5cb14_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='timesheet',
            unique_together={('staff', 'start_date', 'end_date', 'restaurant')},
        ),
        migrations.AlterUniqueTogether(
            name='timesheetentry',
            unique_together={('timesheet', 'shift')},
        ),
        migrations.AlterUniqueTogether(
            name='weeklyschedule',
            unique_together={('restaurant', 'week_start')},
        ),
        migrations.AddIndex(
            model_name='assignedshift',
            index=models.Index(fields=['staff', 'shift_date'], name='assigned_sh_staff_i_dec37e_idx'),
        ),
        migrations.AddIndex(
            model_name='assignedshift',
            index=models.Index(fields=['status', 'shift_date'], name='assigned_sh_status_1439b9_idx'),
        ),
    ]
