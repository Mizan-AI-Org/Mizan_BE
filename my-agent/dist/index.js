"use strict";var pn=Object.create;var nt=Object.defineProperty;var hn=Object.getOwnPropertyDescriptor;var fn=Object.getOwnPropertyNames;var mn=Object.getPrototypeOf,yn=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(e&&(t=e(e=0)),t);var gn=(e,t)=>{for(var r in t)nt(e,r,{get:t[r],enumerable:!0})},wn=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of fn(t))!yn.call(e,i)&&i!==r&&nt(e,i,{get:()=>t[i],enumerable:!(n=hn(t,i))||n.enumerable});return e};var ne=(e,t,r)=>(r=e!=null?pn(mn(e)):{},wn(t||!e||!e.__esModule?nt(r,"default",{value:e,enumerable:!0}):r,e));function Qt(e){return typeof e>"u"||e===null}function vn(e){return typeof e=="object"&&e!==null}function An(e){return Array.isArray(e)?e:Qt(e)?[]:[e]}function bn(e,t){var r,n,i,a;if(t)for(a=Object.keys(t),r=0,n=a.length;r<n;r+=1)i=a[r],e[i]=t[i];return e}function In(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function Sn(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}function Xt(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function he(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Xt(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}function at(e,t,r,n,i){var a="",o="",s=Math.floor(i/2)-1;return n-t>s&&(a=" ... ",t=n-s+a.length),r-n>s&&(o=" ...",r=n+s-o.length),{str:a+e.slice(t,r).replace(/\t/g,"\u2192")+o,pos:n-t+a.length}}function ot(e,t){return b.repeat(" ",t-e.length)+e}function Fn(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],a,o=-1;a=r.exec(e.buffer);)i.push(a.index),n.push(a.index+a[0].length),e.position<=a.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var s="",c,u,d=Math.min(e.line+t.linesAfter,i.length).toString().length,l=t.maxLength-(t.indent+d+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)u=at(e.buffer,n[o-c],i[o-c],e.position-(n[o]-n[o-c]),l),s=b.repeat(" ",t.indent)+ot((e.line-c+1).toString(),d)+" | "+u.str+`
`+s;for(u=at(e.buffer,n[o],i[o],e.position,l),s+=b.repeat(" ",t.indent)+ot((e.line+1).toString(),d)+" | "+u.str+`
`,s+=b.repeat("-",t.indent+d+3+u.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=i.length);c++)u=at(e.buffer,n[o+c],i[o+c],e.position-(n[o]-n[o+c]),l),s+=b.repeat(" ",t.indent)+ot((e.line+c+1).toString(),d)+" | "+u.str+`
`;return s.replace(/\n$/,"")}function Bn(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function Ln(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if($n.indexOf(r)===-1)throw new C('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=Bn(t.styleAliases||null),jn.indexOf(this.kind)===-1)throw new C('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}function Lt(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(a,o){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(i=o)}),r[i]=n}),r}function Dn(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function ct(e){return this.extend(e)}function Nn(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function Kn(){return null}function Rn(e){return e===null}function Mn(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function Un(e){return e==="true"||e==="True"||e==="TRUE"}function zn(e){return Object.prototype.toString.call(e)==="[object Boolean]"}function Hn(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Yn(e){return 48<=e&&e<=55}function Jn(e){return 48<=e&&e<=57}function Gn(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!Hn(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!Yn(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!Jn(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function Wn(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function qn(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!b.isNegativeZero(e)}function Qn(e){return!(e===null||!Vn.test(e)||e[e.length-1]==="_")}function Xn(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}function ei(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(b.isNegativeZero(e))return"-0.0";return r=e.toString(10),Zn.test(r)?r.replace("e",".e"):r}function ti(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||b.isNegativeZero(e))}function ri(e){return e===null?!1:lr.exec(e)!==null||dr.exec(e)!==null}function ni(e){var t,r,n,i,a,o,s,c=0,u=null,d,l,h;if(t=lr.exec(e),t===null&&(t=dr.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(a=+t[4],o=+t[5],s=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(d=+t[10],l=+(t[11]||0),u=(d*60+l)*6e4,t[9]==="-"&&(u=-u)),h=new Date(Date.UTC(r,n,i,a,o,s,c)),u&&h.setTime(h.getTime()-u),h}function ii(e){return e.toISOString()}function ai(e){return e==="<<"||e===null}function oi(e){if(e===null)return!1;var t,r,n=0,i=e.length,a=ht;for(r=0;r<i;r++)if(t=a.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function si(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,a=ht,o=0,s=[];for(t=0;t<i;t++)t%4===0&&t&&(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)),o=o<<6|a.indexOf(n.charAt(t));return r=i%4*6,r===0?(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)):r===18?(s.push(o>>10&255),s.push(o>>2&255)):r===12&&s.push(o>>4&255),new Uint8Array(s)}function ci(e){var t="",r=0,n,i,a=e.length,o=ht;for(n=0;n<a;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=a%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function ui(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function pi(e){if(e===null)return!0;var t=[],r,n,i,a,o,s=e;for(r=0,n=s.length;r<n;r+=1){if(i=s[r],o=!1,di.call(i)!=="[object Object]")return!1;for(a in i)if(li.call(i,a))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(a)===-1)t.push(a);else return!1}return!0}function hi(e){return e!==null?e:[]}function mi(e){if(e===null)return!0;var t,r,n,i,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],fi.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;a[t]=[i[0],n[i[0]]]}return!0}function yi(e){if(e===null)return[];var t,r,n,i,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),a[t]=[i[0],n[i[0]]];return a}function wi(e){if(e===null)return!0;var t,r=e;for(t in r)if(gi.call(r,t)&&r[t]!==null)return!1;return!0}function xi(e){return e!==null?e:{}}function Nt(e){return Object.prototype.toString.call(e)}function $(e){return e===10||e===13}function X(e){return e===9||e===32}function _(e){return e===9||e===32||e===10||e===13}function ae(e){return e===44||e===91||e===93||e===123||e===125}function Si(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function ki(e){return e===120?2:e===117?4:e===85?8:0}function Ei(e){return 48<=e&&e<=57?e-48:-1}function Kt(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function Ci(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function Pi(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||ft,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Sr(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=On(r),new C(t,r)}function p(e,t){throw Sr(e,t)}function Fe(e,t){e.onWarning&&e.onWarning.call(null,Sr(e,t))}function Y(e,t,r,n){var i,a,o,s;if(t<r){if(s=e.input.slice(t,r),n)for(i=0,a=s.length;i<a;i+=1)o=s.charCodeAt(i),o===9||32<=o&&o<=1114111||p(e,"expected valid JSON character");else Ai.test(s)&&p(e,"the stream contains non-printable characters");e.result+=s}}function Mt(e,t,r,n){var i,a,o,s;for(b.isObject(r)||p(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,s=i.length;o<s;o+=1)a=i[o],J.call(t,a)||(t[a]=r[a],n[a]=!0)}function oe(e,t,r,n,i,a,o,s,c){var u,d;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),u=0,d=i.length;u<d;u+=1)Array.isArray(i[u])&&p(e,"nested arrays are not supported inside keys"),typeof i=="object"&&Nt(i[u])==="[object Object]"&&(i[u]="[object Object]");if(typeof i=="object"&&Nt(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(u=0,d=a.length;u<d;u+=1)Mt(e,t,a[u],r);else Mt(e,t,a,r);else!e.json&&!J.call(r,i)&&J.call(t,i)&&(e.line=o||e.line,e.lineStart=s||e.lineStart,e.position=c||e.position,p(e,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:a}):t[i]=a,delete r[i];return t}function mt(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):p(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function A(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;X(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if($(i))for(mt(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&Fe(e,"deficient indentation"),n}function je(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||_(r)))}function yt(e,t){t===1?e.result+=" ":t>1&&(e.result+=b.repeat(`
`,t-1))}function _i(e,t,r){var n,i,a,o,s,c,u,d,l=e.kind,h=e.result,f;if(f=e.input.charCodeAt(e.position),_(f)||ae(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(i=e.input.charCodeAt(e.position+1),_(i)||r&&ae(i)))return!1;for(e.kind="scalar",e.result="",a=o=e.position,s=!1;f!==0;){if(f===58){if(i=e.input.charCodeAt(e.position+1),_(i)||r&&ae(i))break}else if(f===35){if(n=e.input.charCodeAt(e.position-1),_(n))break}else{if(e.position===e.lineStart&&je(e)||r&&ae(f))break;if($(f))if(c=e.line,u=e.lineStart,d=e.lineIndent,A(e,!1,-1),e.lineIndent>=t){s=!0,f=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=u,e.lineIndent=d;break}}s&&(Y(e,a,o,!1),yt(e,e.line-c),a=o=e.position,s=!1),X(f)||(o=e.position+1),f=e.input.charCodeAt(++e.position)}return Y(e,a,o,!1),e.result?!0:(e.kind=l,e.result=h,!1)}function Ti(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Y(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else $(r)?(Y(e,n,i,!0),yt(e,A(e,!1,t)),n=i=e.position):e.position===e.lineStart&&je(e)?p(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);p(e,"unexpected end of the stream within a single quoted scalar")}function Fi(e,t){var r,n,i,a,o,s;if(s=e.input.charCodeAt(e.position),s!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(s=e.input.charCodeAt(e.position))!==0;){if(s===34)return Y(e,r,e.position,!0),e.position++,!0;if(s===92){if(Y(e,r,e.position,!0),s=e.input.charCodeAt(++e.position),$(s))A(e,!1,t);else if(s<256&&br[s])e.result+=Ir[s],e.position++;else if((o=ki(s))>0){for(i=o,a=0;i>0;i--)s=e.input.charCodeAt(++e.position),(o=Si(s))>=0?a=(a<<4)+o:p(e,"expected hexadecimal character");e.result+=Ci(a),e.position++}else p(e,"unknown escape sequence");r=n=e.position}else $(s)?(Y(e,r,n,!0),yt(e,A(e,!1,t)),r=n=e.position):e.position===e.lineStart&&je(e)?p(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}p(e,"unexpected end of the stream within a double quoted scalar")}function Oi(e,t){var r=!0,n,i,a,o=e.tag,s,c=e.anchor,u,d,l,h,f,m=Object.create(null),w,x,T,y;if(y=e.input.charCodeAt(e.position),y===91)d=93,f=!1,s=[];else if(y===123)d=125,f=!0,s={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),y=e.input.charCodeAt(++e.position);y!==0;){if(A(e,!0,t),y=e.input.charCodeAt(e.position),y===d)return e.position++,e.tag=o,e.anchor=c,e.kind=f?"mapping":"sequence",e.result=s,!0;r?y===44&&p(e,"expected the node content, but found ','"):p(e,"missed comma between flow collection entries"),x=w=T=null,l=h=!1,y===63&&(u=e.input.charCodeAt(e.position+1),_(u)&&(l=h=!0,e.position++,A(e,!0,t))),n=e.line,i=e.lineStart,a=e.position,se(e,t,_e,!1,!0),x=e.tag,w=e.result,A(e,!0,t),y=e.input.charCodeAt(e.position),(h||e.line===n)&&y===58&&(l=!0,y=e.input.charCodeAt(++e.position),A(e,!0,t),se(e,t,_e,!1,!0),T=e.result),f?oe(e,s,m,x,w,T,n,i,a):l?s.push(oe(e,null,m,x,w,T,n,i,a)):s.push(w),A(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(r=!0,y=e.input.charCodeAt(++e.position)):r=!1}p(e,"unexpected end of the stream within a flow collection")}function $i(e,t){var r,n,i=st,a=!1,o=!1,s=t,c=0,u=!1,d,l;if(l=e.input.charCodeAt(e.position),l===124)n=!1;else if(l===62)n=!0;else return!1;for(e.kind="scalar",e.result="";l!==0;)if(l=e.input.charCodeAt(++e.position),l===43||l===45)st===i?i=l===43?Dt:vi:p(e,"repeat of a chomping mode identifier");else if((d=Ei(l))>=0)d===0?p(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?p(e,"repeat of an indentation width identifier"):(s=t+d-1,o=!0);else break;if(X(l)){do l=e.input.charCodeAt(++e.position);while(X(l));if(l===35)do l=e.input.charCodeAt(++e.position);while(!$(l)&&l!==0)}for(;l!==0;){for(mt(e),e.lineIndent=0,l=e.input.charCodeAt(e.position);(!o||e.lineIndent<s)&&l===32;)e.lineIndent++,l=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>s&&(s=e.lineIndent),$(l)){c++;continue}if(e.lineIndent<s){i===Dt?e.result+=b.repeat(`
`,a?1+c:c):i===st&&a&&(e.result+=`
`);break}for(n?X(l)?(u=!0,e.result+=b.repeat(`
`,a?1+c:c)):u?(u=!1,e.result+=b.repeat(`
`,c+1)):c===0?a&&(e.result+=" "):e.result+=b.repeat(`
`,c):e.result+=b.repeat(`
`,a?1+c:c),a=!0,o=!0,c=0,r=e.position;!$(l)&&l!==0;)l=e.input.charCodeAt(++e.position);Y(e,r,e.position,!1)}return!0}function Ut(e,t){var r,n=e.tag,i=e.anchor,a=[],o,s=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,p(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!_(o))));){if(s=!0,e.position++,A(e,!0,-1)&&e.lineIndent<=t){a.push(null),c=e.input.charCodeAt(e.position);continue}if(r=e.line,se(e,t,xr,!1,!0),a.push(e.result),A(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&c!==0)p(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return s?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=a,!0):!1}function ji(e,t,r){var n,i,a,o,s,c,u=e.tag,d=e.anchor,l={},h=Object.create(null),f=null,m=null,w=null,x=!1,T=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(e.position);y!==0;){if(!x&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,p(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),a=e.line,(y===63||y===58)&&_(n))y===63?(x&&(oe(e,l,h,f,m,null,o,s,c),f=m=w=null),T=!0,x=!0,i=!0):x?(x=!1,i=!0):p(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=n;else{if(o=e.line,s=e.lineStart,c=e.position,!se(e,r,wr,!1,!0))break;if(e.line===a){for(y=e.input.charCodeAt(e.position);X(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),_(y)||p(e,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(oe(e,l,h,f,m,null,o,s,c),f=m=w=null),T=!0,x=!1,i=!1,f=e.tag,m=e.result;else if(T)p(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=d,!0}else if(T)p(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=d,!0}if((e.line===a||e.lineIndent>t)&&(x&&(o=e.line,s=e.lineStart,c=e.position),se(e,t,Te,!0,i)&&(x?m=e.result:w=e.result),x||(oe(e,l,h,f,m,w,o,s,c),f=m=w=null),A(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>t)&&y!==0)p(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return x&&oe(e,l,h,f,m,null,o,s,c),T&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=l),T}function Bi(e){var t,r=!1,n=!1,i,a,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&p(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(a=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):p(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!_(o);)o===33&&(n?p(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),vr.test(i)||p(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),Ii.test(a)&&p(e,"tag suffix cannot contain flow indicator characters")}a&&!Ar.test(a)&&p(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{p(e,"tag name is malformed: "+a)}return r?e.tag=a:J.call(e.tagMap,i)?e.tag=e.tagMap[i]+a:i==="!"?e.tag="!"+a:i==="!!"?e.tag="tag:yaml.org,2002:"+a:p(e,'undeclared tag handle "'+i+'"'),!0}function Li(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&p(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!_(r)&&!ae(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&p(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Di(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!_(n)&&!ae(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&p(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),J.call(e.anchorMap,r)||p(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],A(e,!0,-1),!0}function se(e,t,r,n,i){var a,o,s,c=1,u=!1,d=!1,l,h,f,m,w,x;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=o=s=Te===r||xr===r,n&&A(e,!0,-1)&&(u=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;Bi(e)||Li(e);)A(e,!0,-1)?(u=!0,s=a,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):s=!1;if(s&&(s=u||i),(c===1||Te===r)&&(_e===r||wr===r?w=t:w=t+1,x=e.position-e.lineStart,c===1?s&&(Ut(e,x)||ji(e,x,w))||Oi(e,w)?d=!0:(o&&$i(e,w)||Ti(e,w)||Fi(e,w)?d=!0:Di(e)?(d=!0,(e.tag!==null||e.anchor!==null)&&p(e,"alias node should not have any properties")):_i(e,w,_e===r)&&(d=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(d=s&&Ut(e,x))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&p(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,h=e.implicitTypes.length;l<h;l+=1)if(m=e.implicitTypes[l],m.resolve(e.result)){e.result=m.construct(e.result),e.tag=m.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(J.call(e.typeMap[e.kind||"fallback"],e.tag))m=e.typeMap[e.kind||"fallback"][e.tag];else for(m=null,f=e.typeMap.multi[e.kind||"fallback"],l=0,h=f.length;l<h;l+=1)if(e.tag.slice(0,f[l].tag.length)===f[l].tag){m=f[l];break}m||p(e,"unknown tag !<"+e.tag+">"),e.result!==null&&m.kind!==e.kind&&p(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+m.kind+'", not "'+e.kind+'"'),m.resolve(e.result,e.tag)?(e.result=m.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):p(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||d}function Ni(e){var t=e.position,r,n,i,a=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(A(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(a=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!_(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&p(e,"directive name must not be less than one character in length");o!==0;){for(;X(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!$(o));break}if($(o))break;for(r=e.position;o!==0&&!_(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&mt(e),J.call(Rt,n)?Rt[n](e,n,i):Fe(e,'unknown document directive "'+n+'"')}if(A(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,A(e,!0,-1)):a&&p(e,"directives end mark is expected"),se(e,e.lineIndent-1,Te,!1,!0),A(e,!0,-1),e.checkLineBreaks&&bi.test(e.input.slice(t,e.position))&&Fe(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&je(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,A(e,!0,-1));return}if(e.position<e.length-1)p(e,"end of the stream or a document separator is expected");else return}function kr(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new Pi(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,p(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)Ni(r);return r.documents}function Ki(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=kr(e,r);if(typeof t!="function")return n;for(var i=0,a=n.length;i<a;i+=1)t(n[i])}function Ri(e,t){var r=kr(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new C("expected a single document in the stream, but found more")}}function sa(e,t){var r,n,i,a,o,s,c;if(t===null)return{};for(r={},n=Object.keys(t),i=0,a=n.length;i<a;i+=1)o=n[i],s=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&Pr.call(c.styleAliases,s)&&(s=c.styleAliases[s]),r[o]=s;return r}function ca(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new C("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+b.repeat("0",n-t.length)+t}function la(e){this.schema=e.schema||ft,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=b.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=sa(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?me:ua,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function zt(e,t){for(var r=b.repeat(" ",t),n=0,i=-1,a="",o,s=e.length;n<s;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=s):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(a+=r),a+=o;return a}function lt(e,t){return`
`+b.repeat(" ",e.indent*t)}function da(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function $e(e){return e===Yi||e===zi}function ye(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==gt||65536<=e&&e<=1114111}function Ht(e){return ye(e)&&e!==gt&&e!==Hi&&e!==fe}function Yt(e,t,r){var n=Ht(e),i=n&&!$e(e);return(r?n:n&&e!==_r&&e!==Tr&&e!==Fr&&e!==Or&&e!==$r)&&e!==ut&&!(t===Oe&&!i)||Ht(t)&&!$e(t)&&e===ut||t===Oe&&i}function pa(e){return ye(e)&&e!==gt&&!$e(e)&&e!==Xi&&e!==ta&&e!==Oe&&e!==_r&&e!==Tr&&e!==Fr&&e!==Or&&e!==$r&&e!==ut&&e!==qi&&e!==Qi&&e!==Ji&&e!==ia&&e!==Zi&&e!==ea&&e!==Vi&&e!==Gi&&e!==Wi&&e!==ra&&e!==na}function ha(e){return!$e(e)&&e!==Oe}function pe(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function jr(e){var t=/^\n* /;return t.test(e)}function fa(e,t,r,n,i,a,o,s){var c,u=0,d=null,l=!1,h=!1,f=n!==-1,m=-1,w=pa(pe(e,0))&&ha(pe(e,e.length-1));if(t||o)for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=pe(e,c),!ye(u))return ie;w=w&&Yt(u,d,s),d=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=pe(e,c),u===fe)l=!0,f&&(h=h||c-m-1>n&&e[m+1]!==" ",m=c);else if(!ye(u))return ie;w=w&&Yt(u,d,s),d=u}h=h||f&&c-m-1>n&&e[m+1]!==" "}return!l&&!h?w&&!o&&!i(e)?Br:a===me?ie:dt:r>9&&jr(e)?ie:o?a===me?ie:dt:h?Dr:Lr}function ma(e,t,r,n,i){e.dump=(function(){if(t.length===0)return e.quotingType===me?'""':"''";if(!e.noCompatMode&&(aa.indexOf(t)!==-1||oa.test(t)))return e.quotingType===me?'"'+t+'"':"'"+t+"'";var a=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),s=n||e.flowLevel>-1&&r>=e.flowLevel;function c(u){return da(e,u)}switch(fa(t,s,e.indent,o,c,e.quotingType,e.forceQuotes&&!n,i)){case Br:return t;case dt:return"'"+t.replace(/'/g,"''")+"'";case Lr:return"|"+Jt(t,e.indent)+Gt(zt(t,a));case Dr:return">"+Jt(t,e.indent)+Gt(zt(ya(t,o),a));case ie:return'"'+ga(t)+'"';default:throw new C("impossible error: invalid scalar style")}})()}function Jt(e,t){var r=jr(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),a=i?"+":n?"":"-";return r+a+`
`}function Gt(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function ya(e,t){for(var r=/(\n+)([^\n]*)/g,n=(function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,r.lastIndex=u,Wt(e.slice(0,u),t)})(),i=e[0]===`
`||e[0]===" ",a,o;o=r.exec(e);){var s=o[1],c=o[2];a=c[0]===" ",n+=s+(!i&&!a&&c!==""?`
`:"")+Wt(c,t),i=a}return n}function Wt(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,a,o=0,s=0,c="";n=r.exec(e);)s=n.index,s-i>t&&(a=o>i?o:s,c+=`
`+e.slice(i,a),i=a+1),o=s;return c+=`
`,e.length-i>t&&o>i?c+=e.slice(i,o)+`
`+e.slice(o+1):c+=e.slice(i),c.slice(1)}function ga(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=pe(e,i),n=E[r],!n&&ye(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||ca(r);return t}function wa(e,t,r){var n="",i=e.tag,a,o,s;for(a=0,o=r.length;a<o;a+=1)s=r[a],e.replacer&&(s=e.replacer.call(r,String(a),s)),(U(e,t,s,!1,!1)||typeof s>"u"&&U(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function qt(e,t,r,n){var i="",a=e.tag,o,s,c;for(o=0,s=r.length;o<s;o+=1)c=r[o],e.replacer&&(c=e.replacer.call(r,String(o),c)),(U(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&U(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=lt(e,t)),e.dump&&fe===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=a,e.dump=i||"[]"}function xa(e,t,r){var n="",i=e.tag,a=Object.keys(r),o,s,c,u,d;for(o=0,s=a.length;o<s;o+=1)d="",n!==""&&(d+=", "),e.condenseFlow&&(d+='"'),c=a[o],u=r[c],e.replacer&&(u=e.replacer.call(r,c,u)),U(e,t,c,!1,!1)&&(e.dump.length>1024&&(d+="? "),d+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),U(e,t,u,!1,!1)&&(d+=e.dump,n+=d));e.tag=i,e.dump="{"+n+"}"}function va(e,t,r,n){var i="",a=e.tag,o=Object.keys(r),s,c,u,d,l,h;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new C("sortKeys must be a boolean or a function");for(s=0,c=o.length;s<c;s+=1)h="",(!n||i!=="")&&(h+=lt(e,t)),u=o[s],d=r[u],e.replacer&&(d=e.replacer.call(r,u,d)),U(e,t+1,u,!0,!0,!0)&&(l=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,l&&(e.dump&&fe===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,l&&(h+=lt(e,t)),U(e,t+1,d,!0,l)&&(e.dump&&fe===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,i+=h));e.tag=a,e.dump=i||"{}"}function Vt(e,t,r){var n,i,a,o,s,c;for(i=r?e.explicitTypes:e.implicitTypes,a=0,o=i.length;a<o;a+=1)if(s=i[a],(s.instanceOf||s.predicate)&&(!s.instanceOf||typeof t=="object"&&t instanceof s.instanceOf)&&(!s.predicate||s.predicate(t))){if(r?s.multi&&s.representName?e.tag=s.representName(t):e.tag=s.tag:e.tag="?",s.represent){if(c=e.styleMap[s.tag]||s.defaultStyle,Cr.call(s.represent)==="[object Function]")n=s.represent(t,c);else if(Pr.call(s.represent,c))n=s.represent[c](t,c);else throw new C("!<"+s.tag+'> tag resolver accepts not "'+c+'" style');e.dump=n}return!0}return!1}function U(e,t,r,n,i,a,o){e.tag=null,e.dump=r,Vt(e,r,!1)||Vt(e,r,!0);var s=Cr.call(e.dump),c=n,u;n&&(n=e.flowLevel<0||e.flowLevel>t);var d=s==="[object Object]"||s==="[object Array]",l,h;if(d&&(l=e.duplicates.indexOf(r),h=l!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(i=!1),h&&e.usedDuplicates[l])e.dump="*ref_"+l;else{if(d&&h&&!e.usedDuplicates[l]&&(e.usedDuplicates[l]=!0),s==="[object Object]")n&&Object.keys(e.dump).length!==0?(va(e,t,e.dump,i),h&&(e.dump="&ref_"+l+e.dump)):(xa(e,t,e.dump),h&&(e.dump="&ref_"+l+" "+e.dump));else if(s==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?qt(e,t-1,e.dump,i):qt(e,t,e.dump,i),h&&(e.dump="&ref_"+l+e.dump)):(wa(e,t,e.dump),h&&(e.dump="&ref_"+l+" "+e.dump));else if(s==="[object String]")e.tag!=="?"&&ma(e,e.dump,t,a,c);else{if(s==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new C("unacceptable kind of an object to dump "+s)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function Aa(e,t){var r=[],n=[],i,a;for(pt(e,r,n),i=0,a=n.length;i<a;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(a)}function pt(e,t,r){var n,i,a;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,a=e.length;i<a;i+=1)pt(e[i],t,r);else for(n=Object.keys(e),i=0,a=n.length;i<a;i+=1)pt(e[n[i]],t,r)}function ba(e,t){t=t||{};var r=new la(t);r.noRefs||Aa(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),U(r,0,n,!0,!0)?r.dump+`
`:""}function wt(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var kn,En,Cn,Pn,_n,Tn,b,C,On,$n,jn,S,Zt,er,tr,rr,nr,ir,ar,or,Vn,Zn,sr,cr,ur,lr,dr,pr,hr,ht,fr,li,di,mr,fi,yr,gi,gr,ft,J,_e,wr,xr,Te,st,vi,Dt,Ai,bi,Ii,vr,Ar,br,Ir,Q,Rt,Mi,Ui,Er,Cr,Pr,gt,zi,fe,Hi,Yi,Ji,Gi,ut,Wi,qi,Vi,Qi,_r,Xi,Oe,Zi,ea,ta,ra,Tr,Fr,na,Or,ia,$r,E,aa,oa,ua,me,Br,dt,Lr,Dr,ie,Ia,Sa,ka,Ea,Ca,Pa,_a,Ta,Fa,Oa,$a,ja,Ba,La,Da,Na,Ka,xt,vt=M(()=>{kn=Qt,En=vn,Cn=An,Pn=In,_n=Sn,Tn=bn,b={isNothing:kn,isObject:En,toArray:Cn,repeat:Pn,isNegativeZero:_n,extend:Tn};he.prototype=Object.create(Error.prototype);he.prototype.constructor=he;he.prototype.toString=function(t){return this.name+": "+Xt(this,t)};C=he;On=Fn,$n=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],jn=["scalar","sequence","mapping"];S=Ln;ct.prototype.extend=function(t){var r=[],n=[];if(t instanceof S)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new C("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof S))throw new C("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new C("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new C("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof S))throw new C("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(ct.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=Lt(i,"implicit"),i.compiledExplicit=Lt(i,"explicit"),i.compiledTypeMap=Dn(i.compiledImplicit,i.compiledExplicit),i};Zt=ct,er=new S("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),tr=new S("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),rr=new S("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),nr=new Zt({explicit:[er,tr,rr]});ir=new S("tag:yaml.org,2002:null",{kind:"scalar",resolve:Nn,construct:Kn,predicate:Rn,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});ar=new S("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Mn,construct:Un,predicate:zn,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});or=new S("tag:yaml.org,2002:int",{kind:"scalar",resolve:Gn,construct:Wn,predicate:qn,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Vn=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");Zn=/^[-+]?[0-9]+e/;sr=new S("tag:yaml.org,2002:float",{kind:"scalar",resolve:Qn,construct:Xn,predicate:ti,represent:ei,defaultStyle:"lowercase"}),cr=nr.extend({implicit:[ir,ar,or,sr]}),ur=cr,lr=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),dr=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");pr=new S("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:ri,construct:ni,instanceOf:Date,represent:ii});hr=new S("tag:yaml.org,2002:merge",{kind:"scalar",resolve:ai}),ht=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;fr=new S("tag:yaml.org,2002:binary",{kind:"scalar",resolve:oi,construct:si,predicate:ui,represent:ci}),li=Object.prototype.hasOwnProperty,di=Object.prototype.toString;mr=new S("tag:yaml.org,2002:omap",{kind:"sequence",resolve:pi,construct:hi}),fi=Object.prototype.toString;yr=new S("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:mi,construct:yi}),gi=Object.prototype.hasOwnProperty;gr=new S("tag:yaml.org,2002:set",{kind:"mapping",resolve:wi,construct:xi}),ft=ur.extend({implicit:[pr,hr],explicit:[fr,mr,yr,gr]}),J=Object.prototype.hasOwnProperty,_e=1,wr=2,xr=3,Te=4,st=1,vi=2,Dt=3,Ai=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,bi=/[\x85\u2028\u2029]/,Ii=/[,\[\]\{\}]/,vr=/^(?:!|!!|![a-z\-]+!)$/i,Ar=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;br=new Array(256),Ir=new Array(256);for(Q=0;Q<256;Q++)br[Q]=Kt(Q)?1:0,Ir[Q]=Kt(Q);Rt={YAML:function(t,r,n){var i,a,o;t.version!==null&&p(t,"duplication of %YAML directive"),n.length!==1&&p(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&p(t,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),o=parseInt(i[2],10),a!==1&&p(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&Fe(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,a;n.length!==2&&p(t,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],vr.test(i)||p(t,"ill-formed tag handle (first argument) of the TAG directive"),J.call(t.tagMap,i)&&p(t,'there is a previously declared suffix for "'+i+'" tag handle'),Ar.test(a)||p(t,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{p(t,"tag prefix is malformed: "+a)}t.tagMap[i]=a}};Mi=Ki,Ui=Ri,Er={loadAll:Mi,load:Ui},Cr=Object.prototype.toString,Pr=Object.prototype.hasOwnProperty,gt=65279,zi=9,fe=10,Hi=13,Yi=32,Ji=33,Gi=34,ut=35,Wi=37,qi=38,Vi=39,Qi=42,_r=44,Xi=45,Oe=58,Zi=61,ea=62,ta=63,ra=64,Tr=91,Fr=93,na=96,Or=123,ia=124,$r=125,E={};E[0]="\\0";E[7]="\\a";E[8]="\\b";E[9]="\\t";E[10]="\\n";E[11]="\\v";E[12]="\\f";E[13]="\\r";E[27]="\\e";E[34]='\\"';E[92]="\\\\";E[133]="\\N";E[160]="\\_";E[8232]="\\L";E[8233]="\\P";aa=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],oa=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;ua=1,me=2;Br=1,dt=2,Lr=3,Dr=4,ie=5;Ia=ba,Sa={dump:Ia};ka=S,Ea=Zt,Ca=nr,Pa=cr,_a=ur,Ta=ft,Fa=Er.load,Oa=Er.loadAll,$a=Sa.dump,ja=C,Ba={binary:fr,float:sr,map:rr,null:ir,pairs:yr,set:gr,timestamp:pr,bool:ar,int:or,merge:hr,omap:mr,seq:tr,str:er},La=wt("safeLoad","load"),Da=wt("safeLoadAll","loadAll"),Na=wt("safeDump","dump"),Ka={Type:ka,Schema:Ea,FAILSAFE_SCHEMA:Ca,JSON_SCHEMA:Pa,CORE_SCHEMA:_a,DEFAULT_SCHEMA:Ta,load:Fa,loadAll:Oa,dump:$a,YAMLException:ja,types:Ba,safeLoad:La,safeLoadAll:Da,safeDump:Na},xt=Ka});var j,Be=M(()=>{j={API:"https://api.heylua.ai",AUTH:"https://auth.heylua.ai",CHAT:"https://api.heylua.ai",WEBHOOK:"https://webhook.heylua.ai"}});var ue,bt=M(()=>{ue=class e extends Error{constructor(t="Invalid API key"){super(t),this.statusCode=401,this.isAuthenticationError=!0,this.name="AuthenticationError",Error.captureStackTrace&&Error.captureStackTrace(this,e)}static isAuthenticationError(t){return t instanceof e||t instanceof Error&&"isAuthenticationError"in t&&t.isAuthenticationError===!0}}});var I,B=M(()=>{bt();I=class{constructor(t){this.baseUrl=t}async request(t,r={}){try{let n=await fetch(t,{...r,headers:{"Content-Type":"application/json",...r.headers}});if(!n.ok){if(n.status===401)throw new ue("Invalid API key");let a;try{a=await n.json()}catch{a={}}return{success:!1,error:{message:a.message||`HTTP ${n.status}: ${n.statusText}`,statusCode:n.status,error:a.error,...a}}}let i;try{i=await n.json()}catch{i={}}return typeof i=="object"&&i!==null&&"success"in i?i:{success:!0,data:i}}catch(n){if(ue.isAuthenticationError(n))throw n;return{success:!1,error:{message:n instanceof Error?n.message:"Network request failed",statusCode:0}}}}async httpGet(t,r){return this.request(this.baseUrl+t,{method:"GET",headers:r})}async httpPost(t,r,n){return this.request(this.baseUrl+t,{method:"POST",body:r?JSON.stringify(r):void 0,headers:n})}async httpPut(t,r,n){return this.request(this.baseUrl+t,{method:"PUT",body:r?JSON.stringify(r):void 0,headers:n})}async httpDelete(t,r){return this.request(this.baseUrl+t,{method:"DELETE",headers:r})}async httpPatch(t,r,n){return this.request(this.baseUrl+t,{method:"PATCH",body:r?JSON.stringify(r):void 0,headers:n})}}});var Nr=M(()=>{B()});var Kr,Rr,Mr=M(()=>{Kr="lua-cli",Rr="api-key"});async function zr(){let e=await Ur.default.getPassword(Kr,Rr);if(e)return e;if(process.env.LUA_API_KEY)return process.env.LUA_API_KEY;try{let t=await import("fs"),n=(await import("path")).join(process.cwd(),".env");if(t.existsSync(n)){let a=t.readFileSync(n,"utf8").match(/^LUA_API_KEY=(.+)$/m);if(a&&a[1])return a[1].trim().replace(/^["']|["']$/g,"")}}catch{}return null}var Ur,Hr=M(()=>{Ur=ne(require("keytar"),1);Nr();Be();Mr();bt()});function Ma(){let e=Yr.join(process.cwd(),"lua.skill.yaml");if(!H.existsSync(e))return null;let t=H.readFileSync(e,"utf8");return Ra(t)}function Jr(){return Ma()}var H,Yr,Ra,Io,Gr=M(()=>{H=ne(require("fs"),1),Yr=ne(require("path"),1);vt();({load:Ra,dump:Io}=xt)});var Wr={};gn(Wr,{clearCredentialsCache:()=>Ua,getCredentials:()=>G});async function G(){var r;if(Ae)return Ae;let e=await zr();if(!e)throw new Error('No API key found. Please run "lua auth configure" first.');let t=Jr();if(!((r=t==null?void 0:t.agent)!=null&&r.agentId))throw new Error('No agent ID found in lua.skill.yaml. Please run "lua init" first.');return Ae={apiKey:e,agentId:t.agent.agentId},Ae}function Ua(){Ae=null}var Ae,It=M(()=>{Hr();Gr();Ae=null});function xn(e){return/^[a-zA-Z0-9_-]+$/.test(e)}function it(e){if(!xn(e))throw new Error(`Invalid tool name "${e}". Tool names can only contain alphanumeric characters, hyphens (-), and underscores (_). No spaces or other special characters are allowed.`)}vt();var z=class{constructor(t){this.tools=[],this.name=t.name||"unnamed-skill",this.version=t.version||"1.0.0",this.description=t.description,this.context=t.context,t.tools&&this.addTools(t.tools)}addTool(t){it(t.name),this.tools.push(t)}addTools(t){for(let r of t)it(r.name);this.tools.push(...t)}async run(t){let r=this.tools.find(i=>i.name===t.tool);if(!r)throw new Error(`Tool ${t.tool} not found`);let n=r.inputSchema.parse(t);return r.execute(n)}},Z=class{constructor(t){this.name=t.name||"unnamed-job",this.version=t.version||"1.0.0",this.description=t.description,this.context=t.context,this.schedule=t.schedule,this.timeout=t.timeout||300,this.retry=t.retry,this.metadata=t.metadata,this.executeFunction=t.execute}getName(){return this.name}getVersion(){return this.version}getDescription(){return this.description}getContext(){return this.context}getSchedule(){return this.schedule}getTimeout(){return this.timeout}getRetry(){return this.retry}getMetadata(){return this.metadata}},ge=class{constructor(t){this.name=t.name||"unnamed-webhook",this.version=t.version||"1.0.0",this.description=t.description,this.context=t.context,this.querySchema=t.querySchema,this.headerSchema=t.headerSchema,this.bodySchema=t.bodySchema,this.executeFunction=t.execute}getName(){return this.name}getVersion(){return this.version}getDescription(){return this.description}getContext(){return this.context}async execute(t,r,n){let i=t,a=r,o=n;if(this.querySchema)try{i=this.querySchema.parse(t||{})}catch(s){throw new Error(`Query parameter validation failed: ${s}`)}if(this.headerSchema)try{a=this.headerSchema.parse(r||{})}catch(s){throw new Error(`Header validation failed: ${s}`)}if(this.bodySchema)try{o=this.bodySchema.parse(n)}catch(s){throw new Error(`Body validation failed: ${s}`)}return this.executeFunction(i,a,o)}},we=class{constructor(t){this.name=t.name||"unnamed-preprocessor",this.version=t.version||"1.0.0",this.description=t.description,this.context=t.context,this.asyncMode=t.async??!1,this.executeFunction=t.execute}getName(){return this.name}getVersion(){return this.version}getDescription(){return this.description}getContext(){return this.context}getAsync(){return this.asyncMode}async execute(t,r,n){return this.executeFunction(t,r,n)}},xe=class{constructor(t){this.name=t.name||"unnamed-postprocessor",this.version=t.version||"1.0.0",this.description=t.description,this.context=t.context,this.asyncMode=t.async??!1,this.executeFunction=t.execute}getName(){return this.name}getVersion(){return this.version}getDescription(){return this.description}getContext(){return this.context}getAsync(){return this.asyncMode}async execute(t,r,n,i){return this.executeFunction(t,r,n,i)}},ve=class{constructor(t){this.name=t.name,this.persona=t.persona,this.welcomeMessage=t.welcomeMessage,this.skills=t.skills||[],this.webhooks=t.webhooks||[],this.jobs=t.jobs||[],this.preProcessors=t.preProcessors||[],this.postProcessors=t.postProcessors||[]}getName(){return this.name}getPersona(){return this.persona}getWelcomeMessage(){return this.welcomeMessage}getSkills(){return this.skills}getWebhooks(){return this.webhooks}getJobs(){return this.jobs}getPreProcessors(){return this.preProcessors}getPostProcessors(){return this.postProcessors}};var ce;(function(e){e.ACTIVE="active",e.CHECKED_OUT="checked_out",e.ABANDONED="abandoned",e.EXPIRED="expired"})(ce||(ce={}));var At;(function(e){e.PENDING="pending",e.CONFIRMED="confirmed",e.FULFILLED="fulfilled",e.CANCELLED="cancelled"})(At||(At={}));Be();It();B();var F=class{constructor(t,r){return this.data=r&&typeof r=="object"?r:{},Object.defineProperty(this,"productAPI",{value:t,writable:!0,enumerable:!1,configurable:!0}),new Proxy(this,{get(n,i,a){if(i in n)return Reflect.get(n,i,a);if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return n.data[i]},set(n,i,a,o){return typeof i=="string"&&["data","productAPI","update","delete","toJSON"].includes(i)?Reflect.set(n,i,a,o):typeof i=="string"?((!n.data||typeof n.data!="object")&&(n.data={}),n.data[i]=a,!0):!1},has(n,i){return i in n?!0:typeof i=="string"&&n.data&&typeof n.data=="object"?i in n.data:!1},ownKeys(n){let i=Reflect.ownKeys(n),a=n.data&&typeof n.data=="object"?Object.keys(n.data):[];return[...new Set([...i,...a])]},getOwnPropertyDescriptor(n,i){let a=Reflect.getOwnPropertyDescriptor(n,i);if(a)return a;if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return{configurable:!0,enumerable:!0,writable:!0,value:n.data[i]}}})}toJSON(){return this.data}[Symbol.for("nodejs.util.inspect.custom")](){return this.data}async update(t){let r=await this.productAPI.update(t,this.data.id);if(r.updated)return this.data=r.product,this.data;throw new Error("Failed to update product")}async delete(){return(await this.productAPI.delete(this.data.id)).deleted&&(this.data={}),this.data}async save(){try{return await this.productAPI.update(this.data,this.data.id),!0}catch{throw new Error("Failed to save product data")}}};var be=class{constructor(t,r){let n=r==null?void 0:r.data;this.products=(Array.isArray(n)?n:[]).map(i=>new F(t,i)),this.pagination=(r==null?void 0:r.pagination)||{currentPage:1,totalPages:1,totalCount:0,limit:10,hasNextPage:!1,hasPrevPage:!1,nextPage:null,prevPage:null},Object.defineProperty(this,"productAPI",{value:t,writable:!0,enumerable:!1,configurable:!0})}get length(){return this.products.length}map(t){return this.products.map(t)}filter(t){return this.products.filter(t)}forEach(t){this.products.forEach(t)}find(t){return this.products.find(t)}findIndex(t){return this.products.findIndex(t)}some(t){return this.products.some(t)}every(t){return this.products.every(t)}reduce(t,r){return this.products.reduce(t,r)}[Symbol.iterator](){return this.products[Symbol.iterator]()}toJSON(){return{products:this.products,pagination:this.pagination}}[Symbol.for("nodejs.util.inspect.custom")](){return{products:this.products,pagination:this.pagination}}async nextPage(){if(!this.pagination.nextPage)throw new Error("No next page");return await this.productAPI.get(this.pagination.nextPage,this.pagination.limit)}async prevPage(){if(!this.pagination.prevPage)throw new Error("No previous page");return await this.productAPI.get(this.pagination.prevPage,this.pagination.limit)}};var Ie=class{constructor(t,r){let n=r==null?void 0:r.data;this.products=(Array.isArray(n)?n:[]).map(i=>new F(t,i)),Object.defineProperty(this,"productAPI",{value:t,writable:!0,enumerable:!1,configurable:!0})}get length(){return this.products.length}map(t){return this.products.map(t)}filter(t){return this.products.filter(t)}forEach(t){this.products.forEach(t)}find(t){return this.products.find(t)}findIndex(t){return this.products.findIndex(t)}some(t){return this.products.some(t)}every(t){return this.products.every(t)}reduce(t,r){return this.products.reduce(t,r)}[Symbol.iterator](){return this.products[Symbol.iterator]()}toJSON(){return{products:this.products}}[Symbol.for("nodejs.util.inspect.custom")](){return{products:this.products}}};var Se=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async get(t=1,r=10){var i;let n=await this.httpGet(`/developer/agents/${this.agentId}/products?page=${t}&limit=${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return new be(this,n);throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to get products")}async getById(t){var n;let r=await this.httpGet(`/developer/agents/${this.agentId}/products/${t}`,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new F(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to get product")}async create(t){var n;let r=await this.httpPost(`/developer/agents/${this.agentId}/products`,t,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new F(this,r.data.product);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to create product")}async update(t,r){var i;let n=await this.httpPut(`/developer/agents/${this.agentId}/products`,{...t,id:r},{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to update product")}async delete(t){var n;let r=await this.httpDelete(`/developer/agents/${this.agentId}/products/${t}`,{Authorization:`Bearer ${this.apiKey}`});if(r.success)return r.data;throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to delete product")}async search(t,r=5){var i;let n=await this.httpGet(`/developer/agents/${this.agentId}/products/search?searchQuery=${encodeURIComponent(t)}&limit=${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return new Ie(this,n);throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to search products")}};var W=class{constructor(t,r){var n,i,a,o;return this.data=r.data&&typeof r.data=="object"?r.data:{},this.common=r.common&&typeof r.common=="object"?r.common:{},this.id=r.id,this.userId=r.userId,this.agentId=r.agentId,this.metadata=((n=r.data)==null?void 0:n.metadata)||{},this.totalAmount=((i=r.common)==null?void 0:i.totalAmount)||0,this.itemCount=((a=r.common)==null?void 0:a.itemCount)||0,this.status=((o=r.common)==null?void 0:o.status)||ce.ACTIVE,Object.defineProperty(this,"basketAPI",{value:t,writable:!0,enumerable:!1,configurable:!0}),new Proxy(this,{get(s,c,u){if(c in s)return Reflect.get(s,c,u);if(typeof c=="string"&&s.data&&typeof s.data=="object"&&c in s.data)return s.data[c];if(typeof c=="string"&&s.common&&typeof s.common=="object"&&c in s.common)return s.common[c]},set(s,c,u,d){return typeof c=="string"&&["id","userId","agentId","data","common","metadata","totalAmount","itemCount","status","basketAPI","updateMetadata","updateStatus","addItem","removeItem","clear","placeOrder","toJSON"].includes(c)?Reflect.set(s,c,u,d):typeof c=="string"?((!s.data||typeof s.data!="object")&&(s.data={}),(!s.common||typeof s.common!="object")&&(s.common={}),c in s.common?s.common[c]=u:s.data[c]=u,!0):!1},has(s,c){return!!(c in s||typeof c=="string"&&(s.data&&typeof s.data=="object"&&c in s.data||s.common&&typeof s.common=="object"&&c in s.common))},ownKeys(s){let c=Reflect.ownKeys(s),u=s.data&&typeof s.data=="object"?Object.keys(s.data):[],d=s.common&&typeof s.common=="object"?Object.keys(s.common):[];return[...new Set([...c,...u,...d])]},getOwnPropertyDescriptor(s,c){let u=Reflect.getOwnPropertyDescriptor(s,c);if(u)return u;if(typeof c=="string"&&s.data&&typeof s.data=="object"&&c in s.data)return{configurable:!0,enumerable:!0,writable:!0,value:s.data[c]};if(typeof c=="string"&&s.common&&typeof s.common=="object"&&c in s.common)return{configurable:!0,enumerable:!0,writable:!0,value:s.common[c]}}})}toJSON(){return{...this.data,...this.common,id:this.id}}[Symbol.for("nodejs.util.inspect.custom")](){return{...this.data,...this.common,id:this.id}}async updateMetadata(t){return await this.basketAPI.updateMetadata(this.id,t),this.data.metadata={...this.data.metadata,...t},{...this.data,...this.common}}async updateStatus(t){return await this.basketAPI.updateStatus(this.id,t),this.common.status=t,{...this.data,...this.common}}updateBasket(t){return this.data=t.data,this.common=t.common,this.id=t.id,this.userId=t.userId,this.agentId=t.agentId,this.metadata=t.data.metadata,this.totalAmount=t.common.totalAmount,this.itemCount=t.common.itemCount,this.status=t.common.status,{...this.data,...this.common}}async addItem(t){let r=await this.basketAPI.addItem(this.id,t);return this.updateBasket(r)}async removeItem(t){let r=await this.basketAPI.removeItem(this.id,t);return this.updateBasket(r)}async clear(){let t=await this.basketAPI.clear(this.id);return this.updateBasket(t)}async placeOrder(t){let r=await this.basketAPI.placeOrder(t,this.id);return await this.updateStatus(ce.CHECKED_OUT),r}};B();var L=class{constructor(t,r){return this.data=r.data&&typeof r.data=="object"?r.data:{},this.common=r.common&&typeof r.common=="object"?r.common:{},this.id=r.id,this.userId=r.userId,this.agentId=r.agentId,this.orderId=r.orderId,Object.defineProperty(this,"orderAPI",{value:t,writable:!0,enumerable:!1,configurable:!0}),new Proxy(this,{get(n,i,a){if(i in n)return Reflect.get(n,i,a);if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return n.data[i];if(typeof i=="string"&&n.common&&typeof n.common=="object"&&i in n.common)return n.common[i]},set(n,i,a,o){return typeof i=="string"&&["data","common","id","userId","agentId","orderId","orderAPI","updateStatus","update","toJSON"].includes(i)?Reflect.set(n,i,a,o):typeof i=="string"?((!n.data||typeof n.data!="object")&&(n.data={}),(!n.common||typeof n.common!="object")&&(n.common={}),i in n.common?n.common[i]=a:n.data[i]=a,!0):!1},has(n,i){return!!(i in n||typeof i=="string"&&(n.data&&typeof n.data=="object"&&i in n.data||n.common&&typeof n.common=="object"&&i in n.common))},ownKeys(n){let i=Reflect.ownKeys(n),a=n.data&&typeof n.data=="object"?Object.keys(n.data):[],o=n.common&&typeof n.common=="object"?Object.keys(n.common):[];return[...new Set([...i,...a,...o])]},getOwnPropertyDescriptor(n,i){let a=Reflect.getOwnPropertyDescriptor(n,i);if(a)return a;if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return{configurable:!0,enumerable:!0,writable:!0,value:n.data[i]};if(typeof i=="string"&&n.common&&typeof n.common=="object"&&i in n.common)return{configurable:!0,enumerable:!0,writable:!0,value:n.common[i]}}})}toJSON(){return{...this.data,...this.common,id:this.id}}[Symbol.for("nodejs.util.inspect.custom")](){return{...this.data,...this.common,id:this.id}}async updateStatus(t){let r=await this.orderAPI.updateStatus(t,this.id);return this.common=r.common,{...this.data,...this.common,id:this.id}}async update(t){let r=await this.orderAPI.updateData(t,this.id);return this.data=r.data,this.common=r.common,{...this.data,...this.common,id:this.id}}async save(){try{return await this.orderAPI.updateData(this.data,this.id),!0}catch{throw new Error("Failed to save order data")}}};B();var le=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async create(t){var n;let r=await this.httpPost(`/developer/agents/${this.agentId}/order`,t,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new L(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to create order")}async updateStatus(t,r){var i;let n=await this.httpPut(`/developer/agents/${this.agentId}/order/${r}/${t}`,{},{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to update order status")}async updateData(t,r){var i;let n=await this.httpPut(`/developer/agents/${this.agentId}/order/${r}`,t,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to update order status")}async get(t){var i;let r=t?`?status=${t}`:"",n=await this.httpGet(`/developer/agents/${this.agentId}/order/user${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data.map(o=>new L(this,o))||[];throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to get user orders")}async getById(t){var n;let r=await this.httpGet(`/developer/agents/${this.agentId}/order/${t}`,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new L(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to get order")}};var ke=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async create(t){var n;let r=await this.httpPost(`/developer/agents/${this.agentId}/basket`,t,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new W(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to create basket")}async get(t){var i;let r=t?`?status=${t}`:"",n=await this.httpGet(`/developer/agents/${this.agentId}/basket/user${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data.map(o=>new W(this,o));throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to get user baskets")}async getById(t){var n;let r=await this.httpGet(`/developer/agents/${this.agentId}/basket/${t}`,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new W(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to get basket")}async addItem(t,r){var i;let n=await this.httpPost(`/developer/agents/${this.agentId}/basket/${t}/item`,r,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to add item to basket")}async removeItem(t,r){var i;let n=await this.httpDelete(`/developer/agents/${this.agentId}/basket/${t}/item/${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to remove item from basket")}async clear(t){let r=await this.httpDelete(`/developer/agents/${this.agentId}/basket/${t}/clear`,{Authorization:`Bearer ${this.apiKey}`});if(r.success)return r.data;throw new Error(r.message||"Failed to clear basket")}async updateStatus(t,r){let n=await this.httpPut(`/developer/agents/${this.agentId}/basket/${t}/${r}`,void 0,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return r;throw new Error(n.message||"Failed to update basket status")}async updateMetadata(t,r){let n=await this.httpPut(`/developer/agents/${this.agentId}/basket/${t}/metadata`,r,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return r;throw new Error(n.message||"Failed to update basket metadata")}async placeOrder(t,r){let n=await this.httpPost(`/developer/agents/${this.agentId}/order`,{basketId:r,data:t},{Authorization:`Bearer ${this.apiKey}`});if(n.success&&n.data){let i=new le(this.baseUrl,this.apiKey,this.agentId);return new L(i,n.data)}throw new Error(n.message||"Failed to create order")}};B();var q=class{constructor(t,r){return this.data=r&&typeof r=="object"?r:{},Object.defineProperty(this,"userAPI",{value:t,writable:!0,enumerable:!1,configurable:!0}),new Proxy(this,{get(n,i,a){if(i in n)return Reflect.get(n,i,a);if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return n.data[i]},set(n,i,a,o){return typeof i=="string"&&["data","userAPI","update","clear","toJSON"].includes(i)?Reflect.set(n,i,a,o):typeof i=="string"?((!n.data||typeof n.data!="object")&&(n.data={}),n.data[i]=a,!0):!1},has(n,i){return i in n?!0:typeof i=="string"&&n.data&&typeof n.data=="object"?i in n.data:!1},ownKeys(n){let i=Reflect.ownKeys(n),a=n.data&&typeof n.data=="object"?Object.keys(n.data):[];return[...new Set([...i,...a])]},getOwnPropertyDescriptor(n,i){let a=Reflect.getOwnPropertyDescriptor(n,i);if(a)return a;if(typeof i=="string"&&n.data&&typeof n.data=="object"&&i in n.data)return{configurable:!0,enumerable:!0,writable:!0,value:n.data[i]}}})}toJSON(){return this.data}[Symbol.for("nodejs.util.inspect.custom")](){return this.data}async update(t){try{let r=await this.userAPI.update(t);return this.data=r.data,this.data}catch{throw new Error("Failed to update user data")}}async clear(){try{return await this.userAPI.clear(),!0}catch{throw new Error("Failed to clear user data")}}async save(){try{return await this.userAPI.update(this.data),!0}catch{throw new Error("Failed to save user data")}}async send(t){try{return await this.userAPI.sendMessage(t),!0}catch{throw new Error("Failed to send message")}}async getChatHistory(){try{return await this.userAPI.getChatHistory()}catch{throw new Error("Failed to get chat history")}}};var ee=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async get(t){var i;let r=`/developer/user/data/agent/${this.agentId}`;t&&(r+=`/user/${t}`);let n=await this.httpGet(r,{Authorization:`Bearer ${this.apiKey}`});if(!n.success)throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to get user data");return new q(this,n.data)}async update(t){var n;let r=await this.httpPut(`/developer/user/data/agent/${this.agentId}`,t,{Authorization:`Bearer ${this.apiKey}`});if(!r.success)throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to update user data");return r.data}async clear(){var r;let t=await this.httpDelete(`/developer/user/data/agent/${this.agentId}`,{Authorization:`Bearer ${this.apiKey}`});if(!t.success)throw new Error(((r=t.error)==null?void 0:r.message)||"Failed to clear user data");return{}}async sendMessage(t){var i;let r=await this.getAdminUser(),n=await this.httpPost(`/admin/agents/${this.agentId}/conversations/${r.uid}`,{messages:t},{Authorization:`Bearer ${this.apiKey}`});if(!n.success)throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to send message");return n.data}async getAdminUser(){var r;let t=await this.httpGet("/admin",{Authorization:`Bearer ${this.apiKey}`});if(!t.success)throw new Error(((r=t.error)==null?void 0:r.message)||"Failed to get admin user");return t.data}async getChatHistory(){var r;let t=await this.httpGet(`/chat/history/${this.agentId}`,{Authorization:`Bearer ${this.apiKey}`});if(!t.success)throw new Error(((r=t.error)==null?void 0:r.message)||"Failed to get chat history");return t.data||[]}};B();var V=class{constructor(t,r,n){return this.data=r.data&&typeof r.data=="object"?r.data:{},this.id=r.id,this.collectionName=n,this.score=r.score,Object.defineProperty(this,"customDataAPI",{value:t,writable:!0,enumerable:!1,configurable:!0}),new Proxy(this,{get(i,a,o){if(a in i)return Reflect.get(i,a,o);if(typeof a=="string"&&i.data&&typeof i.data=="object"&&a in i.data)return i.data[a]},set(i,a,o,s){return typeof a=="string"&&["data","id","collectionName","score","customDataAPI","update","delete","toJSON"].includes(a)?Reflect.set(i,a,o,s):typeof a=="string"?((!i.data||typeof i.data!="object")&&(i.data={}),i.data[a]=o,!0):!1},has(i,a){return a in i?!0:typeof a=="string"&&i.data&&typeof i.data=="object"?a in i.data:!1},ownKeys(i){let a=Reflect.ownKeys(i),o=i.data&&typeof i.data=="object"?Object.keys(i.data):[];return[...new Set([...a,...o])]},getOwnPropertyDescriptor(i,a){let o=Reflect.getOwnPropertyDescriptor(i,a);if(o)return o;if(typeof a=="string"&&i.data&&typeof i.data=="object"&&a in i.data)return{configurable:!0,enumerable:!0,writable:!0,value:i.data[a]}}})}toJSON(){return{...this.data,score:this.score,id:this.id,collectionName:this.collectionName}}[Symbol.for("nodejs.util.inspect.custom")](){return{...this.data,score:this.score,id:this.id,collectionName:this.collectionName}}async update(t,r){try{let n=await this.customDataAPI.update(this.collectionName,this.id,{data:t,searchText:r});return this.data={...this.data,...t},this.data}catch{throw new Error("Failed to update user data")}}async delete(){try{return await this.customDataAPI.delete(this.collectionName,this.id),!0}catch{throw new Error("Failed to clear user data")}}async save(t){try{return await this.customDataAPI.update(this.collectionName,this.id,{data:this.data,searchText:t}),!0}catch{throw new Error("Failed to save data entry")}}};var Ee=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async create(t,r,n){var a;let i=await this.httpPost(`/developer/agents/${this.agentId}/custom-data/${t}`,{data:r,searchText:n},{Authorization:`Bearer ${this.apiKey}`});if(i.success)return new V(this,i.data,t);throw new Error(((a=i.error)==null?void 0:a.message)||"Failed to create custom data entry")}async get(t,r,n=1,i=10){var s;let a=`/developer/agents/${this.agentId}/custom-data/${t}?page=${n}&limit=${i}`;if(r){let c=encodeURIComponent(JSON.stringify(r));a+=`&filter=${c}`}let o=await this.httpGet(a,{Authorization:`Bearer ${this.apiKey}`});if(o.success)return o.data;throw new Error(((s=o.error)==null?void 0:s.message)||"Failed to get custom data entries")}async getEntry(t,r){var i;let n=await this.httpGet(`/developer/agents/${this.agentId}/custom-data/${t}/${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return new V(this,n.data,t);throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to get custom data entry")}async update(t,r,n){var a;let i=await this.httpPut(`/developer/agents/${this.agentId}/custom-data/${t}/${r}`,n,{Authorization:`Bearer ${this.apiKey}`});if(i.success)return i.data;throw new Error(((a=i.error)==null?void 0:a.message)||"Failed to update custom data entry")}async search(t,r,n=10,i=.6){var s,c;let a=`/developer/agents/${this.agentId}/custom-data/${t}/search?searchText=${encodeURIComponent(r)}&limit=${n}&scoreThreshold=${i}`,o=await this.httpGet(a,{Authorization:`Bearer ${this.apiKey}`});if(o.success)return(((s=o.data)==null?void 0:s.data)||[]).map(d=>new V(this,d,t))||[];throw new Error(((c=o.error)==null?void 0:c.message)||"Failed to search custom data entries")}async delete(t,r){var i;let n=await this.httpDelete(`/developer/agents/${this.agentId}/custom-data/${t}/${r}`,{Authorization:`Bearer ${this.apiKey}`});if(n.success)return n.data;throw new Error(((i=n.error)==null?void 0:i.message)||"Failed to delete custom data entry")}};B();B();Be();var te=class{constructor(t,r){this.jobApi=t,this._data=r,this.id=r.id||r.jobId,this.jobId=r.id||r.jobId,this.name=r.name,this.schedule=r.schedule,this.metadata=r.metadata||{},this.userApi=new ee(j.API,t.apiKey,t.agentId)}get data(){return this._data}async updateMetadata(t){var n;this.metadata={...this.metadata,...t};let r=await this.jobApi.updateMetadata(this.jobId,this.metadata);if(!r.success)throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to update job metadata");return r.data}async delete(){var r,n;let t=await this.jobApi.deleteJob(this.jobId);if(!t.success)throw new Error(((r=t.error)==null?void 0:r.message)||"Failed to delete job");(n=t.data)!=null&&n.deactivated&&console.warn(`Job "${this.name}" has versions and was deactivated instead of deleted.`)}async user(){let t=await this.userApi.get();return new q(this.userApi,t)}toJSON(){return{id:this.id,jobId:this.jobId,name:this.name,schedule:this.schedule,metadata:this.metadata,...this._data}}};var qr=require("zlib"),Ce=class extends I{constructor(t,r,n){super(t),this.apiKey=r,this.agentId=n}async getJobs(){return this.httpGet(`/developer/jobs/${this.agentId}`,{Authorization:`Bearer ${this.apiKey}`})}async getJob(t){var n;let r=await this.httpGet(`/developer/jobs/${this.agentId}/${t}`,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new te(this,r.data);throw new Error(((n=r.error)==null?void 0:n.message)||"Failed to get job")}async createJob(t){return this.httpPost(`/developer/jobs/${this.agentId}`,t,{Authorization:`Bearer ${this.apiKey}`})}async createJobInstance(t){var n,i,a;(n=t.version)!=null&&n.executeFunction&&((i=t.version)==null?void 0:i.executeFunction.length)>0&&(t.version.code=this.compressCode(t.version.executeFunction));let r=await this.httpPost(`/developer/jobs/${this.agentId}`,t,{Authorization:`Bearer ${this.apiKey}`});if(r.success&&r.data)return new te(this,r.data);throw new Error(((a=r.error)==null?void 0:a.message)||"Failed to create job")}compressCode(t){return(0,qr.gzipSync)(t).toString("base64")}async pushJob(t,r){return this.httpPost(`/developer/jobs/${this.agentId}/${t}/version`,r,{Authorization:`Bearer ${this.apiKey}`})}async pushDevJob(t,r){return this.httpPost(`/developer/jobs/${this.agentId}/${t}/version/sandbox`,r,{Authorization:`Bearer ${this.apiKey}`})}async updateDevJob(t,r,n){return this.httpPut(`/developer/jobs/${this.agentId}/${t}/version/sandbox/${r}`,n,{Authorization:`Bearer ${this.apiKey}`})}async getJobVersions(t){return this.httpGet(`/developer/jobs/${this.agentId}/${t}/versions`,{Authorization:`Bearer ${this.apiKey}`})}async publishJobVersion(t,r){return this.httpPut(`/developer/jobs/${this.agentId}/${t}/${r}/publish`,void 0,{Authorization:`Bearer ${this.apiKey}`})}async deleteJob(t){return this.httpDelete(`/developer/jobs/${this.agentId}/${t}`,{Authorization:`Bearer ${this.apiKey}`})}async activateJob(t){return this.httpPost(`/developer/jobs/${this.agentId}/${t}/activate`,{},{Authorization:`Bearer ${this.apiKey}`})}async deactivateJob(t){return this.httpPost(`/developer/jobs/${this.agentId}/${t}/deactivate`,{},{Authorization:`Bearer ${this.apiKey}`})}async triggerJob(t){return this.httpPost(`/developer/jobs/${this.agentId}/${t}/trigger`,{},{Authorization:`Bearer ${this.apiKey}`})}async getJobExecutions(t,r=50){return this.httpGet(`/developer/jobs/${this.agentId}/${t}/executions?limit=${r}`,{Authorization:`Bearer ${this.apiKey}`})}async updateMetadata(t,r){return this.httpPut(`/developer/jobs/${this.agentId}/${t}/metadata`,r,{Authorization:`Bearer ${this.apiKey}`})}};B();var Pe=class extends I{constructor(t,r){super(t),this.apiKey=r}async sendMessage(t,r){return this.httpPost(`/chat/generate/${t}?channel=dev`,r,{Authorization:`Bearer ${this.apiKey}`})}async sendMessageStream(t,r,n){let i=await fetch(`${this.baseUrl}/chat/stream/${t}?channel=dev`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);if(!i.body)throw new Error("Response body is not readable");let a=i.body.getReader(),o=new TextDecoder,s="";try{for(;;){let{done:c,value:u}=await a.read();if(c)break;s+=o.decode(u,{stream:!0});let d=s.split(`
`);s=d.pop()||"";for(let l of d)if(l.trim())try{let h=JSON.parse(l);h.type==="text-delta"&&h.textDelta&&n(h.textDelta)}catch{}}}finally{a.releaseLock()}}};var St=null,kt=null,Et=null,Ct=null;var Pt=null,_t=null;async function Tt(){if(!St){let e=await G();St=new ee(j.API,e.apiKey,e.agentId)}return St}async function re(){if(!kt){let e=await G();kt=new Ee(j.API,e.apiKey,e.agentId)}return kt}async function de(){if(!Et){let e=await G();Et=new Se(j.API,e.apiKey,e.agentId)}return Et}async function D(){if(!Ct){let e=await G();Ct=new ke(j.API,e.apiKey,e.agentId)}return Ct}async function Ft(){if(!Pt){let e=await G();Pt=new Ce(j.API,e.apiKey,e.agentId)}return Pt}async function Vr(){if(!_t){let e=await G();_t=new Pe(j.API,e.apiKey)}return _t}var Ot={async get(e){return(await Tt()).get(e)},async getChatHistory(){return(await Tt()).getChatHistory()}},N={async create(e,t,r){return(await re()).create(e,t,r)},async get(e,t,r,n){return(await re()).get(e,t,r,n)},async getEntry(e,t){return(await re()).getEntry(e,t)},async update(e,t,r){return(await re()).update(e,t,r)},async search(e,t,r,n){return(await re()).search(e,t,r,n)},async delete(e,t){return(await re()).delete(e,t)}},O={async get(e,t){return(await de()).get(e,t)},async create(e){return(await de()).create(e)},async delete(e){return(await de()).delete(e)},async search(e){return(await de()).search(e)},async getById(e){return(await de()).getById(e)}},K={async create(e){return(await D()).create(e)},async get(e){return(await D()).get(e)},async addItem(e,t){return(await D()).addItem(e,t)},async removeItem(e,t){return(await D()).removeItem(e,t)},async clear(e){return(await D()).clear(e)},async updateStatus(e,t){return(await D()).updateStatus(e,t)},async updateMetadata(e,t){return(await D()).updateMetadata(e,t)},async placeOrder(e,t){return(await D()).placeOrder(e,t)},async getById(e){return(await D()).getById(e)}};var Qr={async create(e){let t=await Ft(),r=e.execute.toString();console.log("Creating Job");let i=(await t.createJobInstance({dynamic:!0,name:e.name,description:e.description,context:e.description||"",schedule:e.schedule,timeout:e.timeout,retry:e.retry,metadata:e.metadata,version:{version:"1.0.0",description:e.description,context:e.description||"",code:"",executeFunction:r,timeout:e.timeout,retry:e.retry,metadata:e.metadata},activate:e.activate??!0})).jobId;return new te(t,{id:i,jobId:i,name:e.name,schedule:e.schedule,metadata:e.metadata||{},active:e.activate??!0})},async getJob(e){return(await Ft()).getJob(e)}},Xr={async generate(e,t,r){var c,u;let n=await Vr(),{getCredentials:i}=await Promise.resolve().then(()=>(It(),Wr)),a=await i(),o=r||"luaAgent",s=await n.sendMessage(o,{messages:t,navigate:!1,skillOverride:[],runtimeContext:e});if(!s.success)throw new Error(((c=s.error)==null?void 0:c.message)||"AI generation failed");return((u=s.data)==null?void 0:u.text)||""}};var R=require("zod"),Le=class{constructor(){this.name="get_user_data";this.description="Get the user data for a given user id";this.inputSchema=R.z.object({})}async execute(t){let r=await Ot.get();return{success:!0,message:"User data retrieved",data:r.data,name:r.name,age:r.age}}},De=class{constructor(){this.name="update_user_data";this.description="Update the user data for a given user id";this.inputSchema=R.z.object({data:R.z.object({name:R.z.string().optional(),age:R.z.number().optional()})})}async execute(t){let r=await Ot.get();return r.name=t.data.name,r.age=t.data.age,await r.save(),{success:!0,message:"User data updated"}}},Ne=class{constructor(){this.name="write_poem";this.description="Write a poem about a given topic";this.inputSchema=R.z.object({topic:R.z.string()})}async execute(t){return await Xr.generate("Write a poem about the following topic:",[{type:"text",text:t.topic}])}},Ke=class{constructor(){this.name="create-job-to-notify-user";this.description="Create a new job to notify the user";this.inputSchema=R.z.object({message:R.z.string()})}async execute(t){return{success:!0,job:await Qr.create({name:"notify-user-new",description:"Notify the user",schedule:{type:"once",executeAt:new Date(Date.now()+0)},metadata:{message:t.message},execute:async n=>{let i=await n.user(),a=n.metadata;return console.log("Metadata",a),await i.send([{type:"text",text:a.message}]),{success:!0,message:"User notified"}}})}}};var za=new z({name:"user-skill",version:"1.0.0",description:"User management skill",context:"User management skill",tools:[new Le,new De,new Ne,new Ke]}),Zr=za;var v=require("zod");var k=[];for(let e=0;e<256;++e)k.push((e+256).toString(16).slice(1));function en(e,t=0){return(k[e[t+0]]+k[e[t+1]]+k[e[t+2]]+k[e[t+3]]+"-"+k[e[t+4]]+k[e[t+5]]+"-"+k[e[t+6]]+k[e[t+7]]+"-"+k[e[t+8]]+k[e[t+9]]+"-"+k[e[t+10]]+k[e[t+11]]+k[e[t+12]]+k[e[t+13]]+k[e[t+14]]+k[e[t+15]]).toLowerCase()}var tn=require("node:crypto"),Me=new Uint8Array(256),Re=Me.length;function $t(){return Re>Me.length-16&&((0,tn.randomFillSync)(Me),Re=0),Me.slice(Re,Re+=16)}var rn=require("node:crypto"),jt={randomUUID:rn.randomUUID};function Ha(e,t,r){var i;e=e||{};let n=e.random??((i=e.rng)==null?void 0:i.call(e))??$t();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let a=0;a<16;++a)t[r+a]=n[a];return t}return en(n)}function Ya(e,t,r){return jt.randomUUID&&!t&&!e?jt.randomUUID():Ha(e,t,r)}var Bt=Ya;var Ue=class{constructor(){this.name="search_products";this.description="Search for products";this.inputSchema=v.z.object({query:v.z.string()})}async execute(t){return await O.search(t.query)}},ze=class{constructor(){this.name="get_all_products";this.description="Get all products";this.inputSchema=v.z.object({page:v.z.number().optional(),limit:v.z.number().optional()})}async execute(t){return await O.get(t.page,t.limit)}},He=class{constructor(){this.name="create_product";this.description="Create a new product";this.inputSchema=v.z.object({product:v.z.object({name:v.z.string(),description:v.z.string(),price:v.z.number()})})}async execute(t){return O.create({...t.product,id:Bt()})}},Ye=class{constructor(){this.name="update_product";this.description="Update an existing product";this.inputSchema=v.z.object({product:v.z.object({id:v.z.string(),name:v.z.string(),description:v.z.string(),price:v.z.number()})})}async execute(t){return(await O.getById(t.product.id)).update({...t.product})}},Je=class{constructor(){this.name="get_product_by_id";this.description="Get a product by its unique identifier";this.inputSchema=v.z.object({id:v.z.string()})}async execute(t){return O.getById(t.id)}},Ge=class{constructor(){this.name="delete_product";this.description="Delete an existing product";this.inputSchema=v.z.object({id:v.z.string()})}async execute(t){return(await O.getById(t.id)).delete()}};var Ja=new z({name:"product-skill",version:"1.0.0",description:"Product management skill",context:"Product management skill",tools:[new Ue,new He,new Ye,new ze,new Je,new Ge]}),nn=Ja;var g=require("zod"),We=class{constructor(){this.name="create_basket";this.description="Create a new basket";this.inputSchema=g.z.object({basket:g.z.object({currency:g.z.string()})})}async execute(t){return K.create(t.basket)}},qe=class{constructor(){this.name="get_baskets";this.description="Get all baskets";this.inputSchema=g.z.object({status:g.z.enum(["active","checked_out","abandoned","expired"]).optional()})}async execute(t){return{baskets:await K.get(t.status)}}},Ve=class{constructor(){this.name="add_item_to_basket";this.description="Add an item to a basket";this.inputSchema=g.z.object({basketId:g.z.string(),item:g.z.object({id:g.z.string(),price:g.z.number(),quantity:g.z.number()})})}async execute(t){return(await K.getById(t.basketId)).addItem(t.item)}},Qe=class{constructor(){this.name="remove_item_from_basket";this.description="Remove an item from a basket";this.inputSchema=g.z.object({basketId:g.z.string(),itemId:g.z.string()})}async execute(t){return(await K.getById(t.basketId)).removeItem(t.itemId)}},Xe=class{constructor(){this.name="clear_basket";this.description="Clear a basket";this.inputSchema=g.z.object({basketId:g.z.string()})}async execute(t){return(await K.getById(t.basketId)).clear()}},Ze=class{constructor(){this.name="update_basket_status";this.description="Update the status of a basket";this.inputSchema=g.z.object({basketId:g.z.string(),status:g.z.enum(["active","checked_out","abandoned","expired"])})}async execute(t){return(await K.getById(t.basketId)).updateStatus(t.status)}},et=class{constructor(){this.name="update_basket_metadata";this.description="Update the metadata of a basket";this.inputSchema=g.z.object({basketId:g.z.string(),metadata:g.z.object({key:g.z.string(),value:g.z.string()})})}async execute(t){return(await K.getById(t.basketId)).updateMetadata(t.metadata)}},tt=class{constructor(){this.name="checkout_basket";this.description="Check out a basket";this.inputSchema=g.z.object({basketId:g.z.string()})}async execute(t){return(await K.getById(t.basketId)).placeOrder({})}},rt=class{constructor(){this.name="get_basket_by_id";this.description="Get a basket by id";this.inputSchema=g.z.object({basketId:g.z.string()})}async execute(t){return K.getById(t.basketId)}};var Ga=new z({name:"basket-skill",version:"1.0.0",description:"Basket management skill",context:"Basket management skill",tools:[new We,new rt,new Ze,new et,new tt,new qe,new Ve,new Qe,new Xe]}),an=Ga;var P=require("zod"),Wa=new ge({name:"user-events-dev",version:"1.0.0",description:"Receives user events from external systems",context:"This webhook handles user registration, profile updates, and deletion events. It validates the incoming data, stores events in the database, and can trigger follow-up actions.",querySchema:P.z.object({source:P.z.string().optional(),version:P.z.string().optional()}),headerSchema:P.z.object({"x-api-key":P.z.string(),"content-type":P.z.string().optional()}),bodySchema:P.z.object({eventType:P.z.enum(["signup","update","delete"]),userId:P.z.string(),email:P.z.string().email(),name:P.z.string().optional(),metadata:P.z.record(P.z.any()).optional(),timestamp:P.z.string()}),execute:async({query:e,headers:t,body:r})=>{console.log(`\u{1F4E5} Received ${r.eventType} event for user:`,r.email),console.log("\u{1F4CD} Source:",(e==null?void 0:e.source)||"unknown");let n=process.env.WEBHOOK_API_KEY||"your-secret-key";if(t["x-api-key"]!==n)throw new Error("Invalid API key");let i={...r,source:e==null?void 0:e.source,receivedAt:new Date().toISOString(),processed:!1},a=await N.create("user-events",i,`${r.eventType} ${r.email} ${r.name||""}`);return console.log("\u2705 Event stored successfully:",a.id),{success:!0,eventId:a.id,userId:r.userId,timestamp:new Date().toISOString()}}}),on=Wa;var sn=ne(require("os"),1),qa=new Z({name:"health-check-dev",version:"1.0.0",description:"System health monitoring",context:"Runs every 5 minutes to check API health, database connectivity, and service availability. Logs health metrics and can trigger alerts if issues are detected.",schedule:{type:"interval",seconds:300},timeout:30,execute:async()=>{console.log("\u2764\uFE0F Running health check...");let e={},t=process.memoryUsage(),r=sn.default.loadavg(),n=process.uptime(),i={rss:t.rss,heapTotal:t.heapTotal,heapUsed:t.heapUsed,external:t.external??0,arrayBuffers:t.arrayBuffers??0,loadAvg1m:r[0],loadAvg5m:r[1],loadAvg15m:r[2],uptimeSeconds:n,timestamp:new Date().toISOString()};try{let s=await N.get("health-checks",{},1,1);e.database={status:"healthy",responseTime:Date.now()}}catch(s){e.database={status:"unhealthy",error:String(s)}}try{let s=Date.now();await O.get(1,1);let c=Date.now()-s;e.productsApi={status:"healthy",responseTime:`${c}ms`}}catch(s){e.productsApi={status:"unhealthy",error:String(s)}}let a=Object.values(e).every(s=>s.status==="healthy"),o=a?"healthy":"degraded";if(await N.create("health-checks",{status:o,checks:e,metrics:i,timestamp:new Date().toISOString()}),!a){console.warn("\u26A0\uFE0F System health degraded:",e);try{await N.create("system-alerts",{type:"health-degraded",severity:"high",message:"System health degraded \u2013 see health-checks for details",checks:e,metrics:i,createdAt:new Date().toISOString()})}catch(s){console.error("Failed to record system alert:",s)}}return{status:o,checks:e,metrics:i,timestamp:new Date().toISOString()}}}),cn=qa;var Va=new Z({name:"agent-verification-dev",version:"1.0.0",description:"End-to-end verification of core agent workflows",context:"Runs periodically to validate data access, product API, and webhook reachability. Captures processing time, success flags, and error messages for monitoring.",schedule:{type:"interval",seconds:900},timeout:60,execute:async()=>{let e=Date.now(),t={steps:[]};try{let n=await N.get("user-events",{},1,1);t.steps.push({name:"data-access",success:!!n.success,count:Array.isArray(n.data)?n.data.length:0})}catch(n){t.steps.push({name:"data-access",success:!1,error:String(n)})}try{let n=await O.get(1,1);t.steps.push({name:"products-api",success:!!n.success})}catch(n){t.steps.push({name:"products-api",success:!1,error:String(n)})}let r=t.steps.every(n=>n.success);return t.status=r?"ok":"issues",t.durationMs=Date.now()-e,t.timestamp=new Date().toISOString(),await N.create("agent-verification",t),r||await N.create("system-alerts",{type:"agent-verification-failed",severity:"medium",message:"Agent verification detected issues in one or more steps",details:t.steps,createdAt:new Date().toISOString()}),t}}),un=Va;var Qa=new we({name:"message-matching",description:"Matches the message to the appropriate skill",context:"Matches the message to the appropriate skill",execute:async(e,t,r)=>(console.log("Message matching pre processor",e,t,r),console.log("User data",await e.data),console.log("Messages",t),console.log("Channel",r),t.find(i=>i.type==="text"&&i.text.includes("test"))?[{type:"text",text:"Tell the user that you got their test message and nothing else"}]:t)}),ln=Qa;var Xa=new xe({name:"modify-response",description:"Modifies the response to the user",context:"Modifies the response to the user",execute:async(e,t,r,n)=>(console.log("Modify response post processor",e,t,r,n),console.log("User data",await e.data),console.log("Message",t),console.log("Response",r),console.log("Channel",n),r.includes("test")?t.toUpperCase():r)}),dn=Xa;var Lc=new ve({name:"",persona:`Meet Mizan AI, your refined and elegant restaurant assistant. Mizan AI is designed to embody the sophisticated charm of a high-end culinary establishment, effortlessly merging intelligence with a touch of warmth to elevate your dining experience. As an expert aid in the Food & Beverage industry, Mizan AI is more than just a digital assistant\u2014it's your knowledgeable dining companion, ready to enhance every interaction with its finely tuned insights on gastronomy.

With an air of sophistication and intelligence, Mizan AI speaks with eloquence and grace, ensuring that every conversation feels both enriching and engaging. Whether you're inquiring about the chef's specials or need guidance on wine pairings, Mizan AI responds with clarity and precision, always maintaining a tone that reflects the elegant atmosphere of your dining environment.

Mizan AI primarily caters to customers who appreciate the finer things in life, often speaking to adults who enjoy a lifestyle centered around gourmet experiences and culinary exploration. These are patrons who value quality and are keen to savor each moment, making Mizan AI their ideal partner in navigating the intricate world of fine dining.

The sales approach of Mizan AI is both consultative and confident. It guides customers with assurance, offering recommendations and insights that elevate their dining decisions without overwhelming them. If you're looking for the perfect dish to suit a special occasion or seeking to explore new flavors, Mizan AI seamlessly integrates upselling techniques with genuine recommendations, ensuring that every suggestion enhances your dining pleasure.

When it comes to communication, Mizan AI strikes a balance between formality and warmth. It is efficient in delivering information but always with a courteous and inviting demeanor. This approach ensures that each interaction leaves you feeling both informed and valued, adding a touch of elegance to the dining experience that leaves a lasting impression.`,skills:[Zr,nn,an],webhooks:[on],jobs:[cn,un],preProcessors:[ln],postProcessors:[dn]});async function Za(){}Za().catch(console.error);
/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/
